"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[1439],{152:(t,e,s)=>{s.d(e,{n:()=>i});class i{constructor(t){this.render=void 0,this.vecs=[],this.pts=[],this.cps=[],this.circle=[],this.polylines=[],this.showFrame=!1,this.showPoint=!0;const e=document.getElementById(t),s=e.getBoundingClientRect(),i=document.createElement("canvas");i.width=s.width,i.height=s.height,e.appendChild(i);const r=i.getContext("2d");let h=-Math.PI/2,l=0,a=!1,c=!1,d=1,u=0,p=0,v=0,g=0,m=0,y=0,w=500;const x=(t,e,s)=>{const i=Math.cos(e),n=Math.sin(e),o=Math.cos(s),r=Math.sin(s);let h=t.x*o-t.y*r,l=t.x*r+t.y*o,a=t.z*i-l*n;return l=t.z*n+l*i,{x:h,y:l,z:a}},f=t=>{const e=w/(w+t.y)*d;return{x:t.x*e+i.width/2+v,y:-t.z*e+i.height/2+g}},b=t=>{let e=x(t,h,l);return f(e)},k=()=>{r.clearRect(0,0,i.width,i.height);for(let s=0;s<this.polylines.length;++s){let t="red";s%3===1?t="green":s%3===2&&(t="blue"),r.strokeStyle=t,r.beginPath();for(let e=0;e<this.polylines[s].length;++e){let t=b(this.polylines[s][e]);0===e?r.moveTo(t.x,t.y):r.lineTo(t.x,t.y)}r.stroke()}const t=[];this.showPoint&&this.pts.forEach((t=>{const e=x(t,h,l),s=f(e),i=w/(w+e.y)*d;let n=t.size*i;n=n<.1?.1:n,r.beginPath(),r.arc(s.x,s.y,n,0,2*Math.PI),r.fillStyle=t.color?t.color:"#f00",r.fill()}));let e=0;this.showFrame&&this.vecs.forEach((s=>{const i=x(s[0],h,l),o=f(i);t.push(o);const a=x(s[1],h,l),c=f(a);let d="red";e%3===1?d="green":e%3===2&&(d="blue"),n(r,o,c,d),e++})),this.cps.forEach((t=>{const e=x(t,h,l),s=f(e);let i=3*(w/(w+e.y)*d);i=i<.1?.1:i,r.beginPath(),r.arc(s.x,s.y,i,0,2*Math.PI),r.fillStyle="#000",r.fill()})),r.beginPath();for(let s=0;s<this.cps.length;++s){const t=x(this.cps[s],h,l),e=f(t);0===s?r.moveTo(e.x,e.y):r.lineTo(e.x,e.y)}r.lineWidth=1,r.strokeStyle="rgba(0,0,0, 0.75)",r.stroke(),this.circle[0]&&o(r,this.circle[0],this.circle[1],b)};this.render=()=>k(),i.addEventListener("mousedown",(t=>{2===t.button?a=!0:0===t.button&&(t.altKey?a=!0:(c=!0,m=t.clientX-v,y=t.clientY-g)),u=t.clientX,p=t.clientY})),i.addEventListener("mousemove",(t=>{if(a){const e=t.clientX-u,s=t.clientY-p;h-=.01*s,l+=.01*e,u=t.clientX,p=t.clientY}else c&&(v=t.clientX-m,g=t.clientY-y)})),i.addEventListener("mouseup",(()=>{a=!1,c=!1})),i.addEventListener("contextmenu",(t=>{t.preventDefault()})),i.addEventListener("wheel",(t=>{const e=t.clientX-i.getBoundingClientRect().left,s=t.clientY-i.getBoundingClientRect().top,n=d,o=Math.max(.001,.02*d);d+=t.deltaY*-o,d=Math.min(Math.max(d,.1),50);const r=d/n;v-=(e-i.width/2-v)*(r-1),g-=(s-i.height/2-g)*(r-1)})),k()}}const n=function(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"black";const n=e,o=s;t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(o.x,o.y),t.closePath(),t.strokeStyle=i,t.lineWidth=2,t.stroke()},o=(t,e,s,i)=>{t.beginPath();for(let n=0;n<=360;n++){const o=n*Math.PI/180;let r=i({x:e.x+s*Math.cos(o),y:e.y+s*Math.sin(o),z:e.z});0===n?t.moveTo(r.x,r.y):t.lineTo(r.x,r.y)}t.closePath(),t.stroke()}},25224:(t,e,s)=>{s.d(e,{D:()=>i,V:()=>n});const i=(t,e,s)=>{const i=document.createElement("div");i.style.display="flex";const n=document.createElement("input");n.type="range",n.min="".concat(e),n.max="".concat(s);const o=document.createElement("div");return o.textContent=t,o.style.color="#aaa",i.appendChild(n),i.appendChild(o),{div:i,slider:n}},n=t=>{const e=document.createElement("div");e.style.display="flex";const s=document.createElement("input");s.type="checkbox",s.defaultChecked=!1;const i=document.createElement("div");return i.textContent=t,i.style.color="#aaa",e.appendChild(s),e.appendChild(i),{div:e,checkBox:s}}},1439:(t,e,s)=>{s.r(e),s.d(e,{Solution:()=>h});var i=s(152),n=s(25224);class o{constructor(t,e,s){this.x=t,this.y=e,this.z=s,this.color="blue",this.size=1}static add(t,e){return new o(t.x+e.x,t.y+e.y,t.z+e.z)}static subtract(t,e){return new o(t.x-e.x,t.y-e.y,t.z-e.z)}static scale(t,e){return new o(t.x*e,t.y*e,t.z*e)}static cross(t,e){return new o(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){const t=this.magnitude();return t<1e-10?new o(0,0,0):new o(this.x/t,this.y/t,this.z/t)}isZero(){return Math.abs(this.x)<1e-10&&Math.abs(this.y)<1e-10&&Math.abs(this.z)<1e-10}}class r{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.controlPoints=void 0,this.knots=void 0,this.weights=void 0,this.degree=void 0,this.periodic=void 0,this.wrappedPoints=void 0,this.degree=e,this.periodic=s,s?(this.wrappedPoints=this.wrapControlPoints(t,e),this.controlPoints=t,this.knots=this.generatePeriodicKnots(this.wrappedPoints.length,e)):(this.controlPoints=t,this.wrappedPoints=t,this.knots=this.generateKnots(t.length,e)),this.weights=Array(this.wrappedPoints.length).fill(1)}basisFunction(t,e,s){if(0===e)return this.knots[t]<=s&&s<this.knots[t+1]?1:0;const i=this.knots[t+e]-this.knots[t],n=this.knots[t+e+1]-this.knots[t+1];return(i?(s-this.knots[t])/i*this.basisFunction(t,e-1,s):0)+(n?(this.knots[t+e+1]-s)/n*this.basisFunction(t+1,e-1,s):0)}secondDerivative(t){t>=1&&(t=1-1e-10);const e=this.controlPoints.length;let s=new o(0,0,0);for(let i=0;i<e-2;i++){const e=this.weights[i]*(this.basisFunction(i,this.degree-2,t)-2*this.basisFunction(i+1,this.degree-2,t)+this.basisFunction(i+2,this.degree-2,t)),n=o.add(this.controlPoints[i+2],o.subtract(o.scale(this.controlPoints[i+1],-2),this.controlPoints[i]));s=o.add(s,o.scale(n,e))}return s}derivativeBasisFunction(t,e,s){if(0===e)return 0;const i=this.knots[t+e]-this.knots[t],n=this.knots[t+e+1]-this.knots[t+1];let o=0,r=0;return Math.abs(i)>1e-10&&(o=e/i*this.basisFunction(t,e-1,s)),Math.abs(n)>1e-10&&(r=e/n*this.basisFunction(t+1,e-1,s)),o-r}derivative(t){this.periodic&&(t-=Math.floor(t)),Math.abs(t-1)<1e-10&&(t=1-1e-10);const e=this.wrappedPoints.length;let s=new o(0,0,0),i=0,n=new o(0,0,0),r=0;for(let h=0;h<e;h++){const e=this.basisFunction(h,this.degree,t),l=this.derivativeBasisFunction(h,this.degree,t),a=this.weights[h];s=o.add(s,o.scale(this.wrappedPoints[h],a*e)),i+=a*e,n=o.add(n,o.scale(this.wrappedPoints[h],a*l)),r+=a*l}if(Math.abs(i)<1e-10)return console.warn("Warning: denominator near zero in derivative"),new o(0,0,0);o.scale(s,1/i);return o.subtract(o.scale(n,1/i),o.scale(s,r/(i*i)))}curvature(t){const e=this.derivative(t),s=this.secondDerivative(t),i=o.cross(e,s),n=e.magnitude();return n<1e-10?0:i.magnitude()/Math.pow(n,3)}osculatingCircleRadius(t){const e=this.curvature(t);return e<1e-10?1/0:1/e}tangent(t){const e=this.derivative(t),s=e.magnitude();if(s<1e-10){const e=1e-5,s=this.evaluate(Math.max(0,t-e)),i=this.evaluate(Math.min(1,t+e)),n=o.subtract(i,s),r=n.magnitude();return r<1e-10?new o(1,0,0):o.scale(n,1/r)}return o.scale(e,1/s)}principalNormal(t){const e=this.derivative(t),s=this.secondDerivative(t),i=o.cross(e,s);return i.isZero()?Math.abs(e.z)>1e-10?new o(1,0,-e.x/e.z).normalize():Math.abs(e.y)>1e-10?new o(1,-e.x/e.y,0).normalize():new o(0,1,0):i.normalize()}movingFrame(t){const e=this.tangent(t),s=this.principalNormal(t),i=o.cross(e,s).normalize();return{tangent:e,normal:o.cross(i,e).normalize(),binormal:i}}isPeriodic(){return this.periodic}getOriginalControlPoints(){return this.controlPoints}getWrappedControlPoints(){return this.wrappedPoints}getKnots(){return this.knots}wrapControlPoints(t,e){if(t.length<e+1)throw new Error("Not enough control points for the specified degree");const s=[...t];for(let i=0;i<e;i++)s.unshift(t[t.length-(e-i)]);for(let i=0;i<e;i++)s.push(t[i]);return s}generatePeriodicKnots(t,e){const s=t+e+1,i=[];for(let o=0;o<s;o++)i.push(o);const n=i[i.length-1];return i.map((t=>t/n))}generateKnots(t,e){const s=t+e+1,i=Array(e+1).fill(0);for(let n=1;n<=s-2*(e+1);n++)i.push(n/(s-2*e-2));return i.concat(Array(e+1).fill(1))}evaluate(t){this.periodic&&(t-=Math.floor(t)),Math.abs(t-1)<1e-10&&(t=1-1e-10);const e=this.wrappedPoints.length;let s=new o(0,0,0),i=0;for(let n=0;n<e;n++){const e=this.basisFunction(n,this.degree,t),r=this.weights[n]*e;r>1e-10&&(i+=r,s=o.add(s,o.scale(this.wrappedPoints[n],r)))}return i<1e-10?(console.warn("Warning: denominator near zero in evaluate"),new o(0,0,0)):o.scale(s,1/i)}validateContinuity(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e-10;if(!this.periodic)return!0;const e=this.evaluate(0),s=this.evaluate(1);return o.subtract(e,s).magnitude()<t}}class h{constructor(t){this.div=void 0,this.renderer=void 0,this.vecs=[],this.cps=[],this.pts=[],this.lns=[],this.circle=[],this.polylines=[],this.t=0,this.tVal=0,this.curve=void 0,this.N=10,this.degree=3,this.div=document.getElementById(t);const e=document.createElement("div");e.style.position="absolute",this.div.appendChild(e);const s=(0,n.D)("N",1,100);s.slider.defaultValue="".concat(this.N),s.slider.addEventListener("input",(t=>{const e=+t.target.value;console.log(s.slider.value),this.N=e,this.removeAll(),this.init()})),e.appendChild(s.div);const o=(0,n.D)("Degree",1,5);o.slider.defaultValue="".concat(this.degree),o.slider.addEventListener("input",(t=>{const e=+t.target.value;console.log(o.slider.value),this.degree=e,this.removeAll(),this.init()})),e.appendChild(o.div);let r=(0,n.V)("show frame");r.checkBox.defaultChecked=!1,r.checkBox.onchange=()=>{this.renderer.showFrame=r.checkBox.checked,console.log(r.checkBox.checked)},e.appendChild(r.div);let h=(0,n.V)("show vertex");h.checkBox.defaultChecked=!0,h.checkBox.onchange=()=>{!0===h.checkBox.checked?this.renderer.showPoint=!0:this.renderer.showPoint=!1},e.appendChild(h.div);const l=(0,n.D)("t",0,100);l.slider.defaultValue="".concat(this.N),l.slider.addEventListener("input",(t=>{const e=+t.target.value;console.log(l.slider.value),this.tVal=.01*e,this.removeAll(),this.init()})),e.appendChild(l.div),this.renderer=new i.n(t),this.renderer.pts=this.pts,this.renderer.vecs=this.vecs,this.renderer.cps=this.cps,this.renderer.circle=this.circle,this.renderer.polylines=this.polylines,this.init(),this.update(),this.render()}init(){const t=[new o(-60,30,0),new o(-40,-30,0),new o(10,80,0),new o(160,20,0),new o(-30,30,0),new o(0,-80,0),new o(80,-120,0)];this.cps.push(...t);const e=new r(t,this.degree,!1),s=1/this.N;for(let r=0;r<=1;r+=s){console.log("\nAt t = ".concat(r.toFixed(1),":"));const t=e.evaluate(r),s=e.movingFrame(r);e.derivative(r);this.pts.push(t),this.polylines.push(t);new o(t.x+s.normal.x,t.y+s.normal.y,t.z+s.normal.z);this.vecs.push([t,o.add(t,o.scale(s.tangent,5))]),this.vecs.push([t,o.add(t,o.scale(s.normal,5))]),this.vecs.push([t,o.add(t,o.scale(s.binormal,5))]);s.tangent.x,s.normal.x,s.tangent.y,s.normal.y,s.tangent.z,s.normal.z}this.curve=e,console.log(this.vecs);const i=this.tVal,n=e.evaluate(i),h=e.movingFrame(i),l=e.osculatingCircleRadius(i),a=o.subtract(n,o.scale(h.binormal,l));this.circle.push(a),this.circle.push(l)}removeAll(){this.cps.length=0,this.pts.length=0,this.vecs.length=0,this.circle.length=0,this.polylines.length=0}update(){for(let t=0;t<this.pts.length;++t);this.t+=.01}render(){requestAnimationFrame((()=>{this.render()})),this.update(),this.renderer.render()}destroy(){try{for(;this.div&&this.div.lastElementChild;){const t=this.div.lastElementChild;this.div.removeChild(t)}}catch(t){console.error("Error removing child elements:",t)}}}}}]);
//# sourceMappingURL=1439.b2556797.chunk.js.map
"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[26309],{152:(t,e,s)=>{s.d(e,{n:()=>i});class i{constructor(t){this.render=void 0,this.vecs=[],this.pts=[],this.cps=[],this.circle=[],this.polylines=[],this.showFrame=!1,this.showPoint=!0;const e=document.getElementById(t),s=e.getBoundingClientRect(),i=document.createElement("canvas");i.width=s.width,i.height=s.height,e.appendChild(i);const r=i.getContext("2d");let o=-Math.PI/2,a=0,l=!1,c=!1,d=1,u=0,g=0,v=0,m=0,p=0,y=0,f=500;const x=(t,e,s)=>{const i=Math.cos(e),n=Math.sin(e),h=Math.cos(s),r=Math.sin(s);let o=t.x*h-t.y*r,a=t.x*r+t.y*h,l=t.z*i-a*n;return a=t.z*n+a*i,{x:o,y:a,z:l}},b=t=>{const e=f/(f+t.y)*d;return{x:t.x*e+i.width/2+v,y:-t.z*e+i.height/2+m}},z=t=>{let e=x(t,o,a);return b(e)},w=()=>{r.clearRect(0,0,i.width,i.height);for(let s=0;s<this.polylines.length;++s){let t="red";s%3===1?t="green":s%3===2&&(t="blue"),r.strokeStyle=t,r.beginPath();for(let e=0;e<this.polylines[s].length;++e){let t=z(this.polylines[s][e]);0===e?r.moveTo(t.x,t.y):r.lineTo(t.x,t.y)}r.stroke()}const t=[];this.showPoint&&this.pts.forEach((t=>{const e=x(t,o,a),s=b(e),i=f/(f+e.y)*d;let n=t.size*i;n=n<.1?.1:n,r.beginPath(),r.arc(s.x,s.y,n,0,2*Math.PI),r.fillStyle=t.color?t.color:"#f00",r.fill()}));let e=0;this.showFrame&&this.vecs.forEach((s=>{const i=x(s[0],o,a),h=b(i);t.push(h);const l=x(s[1],o,a),c=b(l);let d="red";e%3===1?d="green":e%3===2&&(d="blue"),n(r,h,c,d),e++})),this.cps.forEach((t=>{const e=x(t,o,a),s=b(e);let i=3*(f/(f+e.y)*d);i=i<.1?.1:i,r.beginPath(),r.arc(s.x,s.y,i,0,2*Math.PI),r.fillStyle="#000",r.fill()})),r.beginPath();for(let s=0;s<this.cps.length;++s){const t=x(this.cps[s],o,a),e=b(t);0===s?r.moveTo(e.x,e.y):r.lineTo(e.x,e.y)}r.lineWidth=1,r.strokeStyle="rgba(0,0,0, 0.75)",r.stroke(),this.circle[0]&&h(r,this.circle[0],this.circle[1],z)};this.render=()=>w(),i.addEventListener("mousedown",(t=>{2===t.button?l=!0:0===t.button&&(t.altKey?l=!0:(c=!0,p=t.clientX-v,y=t.clientY-m)),u=t.clientX,g=t.clientY})),i.addEventListener("mousemove",(t=>{if(l){const e=t.clientX-u,s=t.clientY-g;o-=.01*s,a+=.01*e,u=t.clientX,g=t.clientY}else c&&(v=t.clientX-p,m=t.clientY-y)})),i.addEventListener("mouseup",(()=>{l=!1,c=!1})),i.addEventListener("contextmenu",(t=>{t.preventDefault()})),i.addEventListener("wheel",(t=>{const e=t.clientX-i.getBoundingClientRect().left,s=t.clientY-i.getBoundingClientRect().top,n=d,h=Math.max(.001,.02*d);d+=t.deltaY*-h,d=Math.min(Math.max(d,.1),50);const r=d/n;v-=(e-i.width/2-v)*(r-1),m-=(s-i.height/2-m)*(r-1)})),w()}}const n=function(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"black";const n=e,h=s;t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(h.x,h.y),t.closePath(),t.strokeStyle=i,t.lineWidth=2,t.stroke()},h=(t,e,s,i)=>{t.beginPath();for(let n=0;n<=360;n++){const h=n*Math.PI/180;let r=i({x:e.x+s*Math.cos(h),y:e.y+s*Math.sin(h),z:e.z});0===n?t.moveTo(r.x,r.y):t.lineTo(r.x,r.y)}t.closePath(),t.stroke()}},25224:(t,e,s)=>{s.d(e,{D:()=>i,V:()=>n});const i=(t,e,s)=>{const i=document.createElement("div");i.style.display="flex";const n=document.createElement("input");n.type="range",n.min="".concat(e),n.max="".concat(s);const h=document.createElement("div");return h.textContent=t,h.style.color="#aaa",i.appendChild(n),i.appendChild(h),{div:i,slider:n}},n=t=>{const e=document.createElement("div");e.style.display="flex";const s=document.createElement("input");s.type="checkbox",s.defaultChecked=!1;const i=document.createElement("div");return i.textContent=t,i.style.color="#aaa",e.appendChild(s),e.appendChild(i),{div:e,checkBox:s}}},26309:(t,e,s)=>{s.r(e),s.d(e,{Solution:()=>a});var i=s(152),n=s(25224);class h{constructor(t,e,s){this.x=t,this.y=e,this.z=s,this.size=2}static add(t,e){return new h(t.x+e.x,t.y+e.y,t.z+e.z)}static subtract(t,e){return new h(t.x-e.x,t.y-e.y,t.z-e.z)}static scale(t,e){return new h(t.x*e,t.y*e,t.z*e)}static cross(t,e){return new h(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)}static dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){const t=this.magnitude();return t<1e-10?new h(0,0,0):h.scale(this,1/t)}isZero(){return Math.abs(this.x)<1e-10&&Math.abs(this.y)<1e-10&&Math.abs(this.z)<1e-10}}class r{constructor(t,e,s,i){this.origin=t,this.tangentU=e,this.tangentV=s,this.normal=i,this.orthonormalize()}orthonormalize(){this.tangentU=this.tangentU.normalize();const t=h.dot(this.tangentU,this.tangentV);this.tangentV=h.subtract(this.tangentV,h.scale(this.tangentU,t)).normalize(),this.normal=h.cross(this.tangentU,this.tangentV).normalize(),this.tangentV=h.cross(this.normal,this.tangentU).normalize()}isValid(){const t=1e-6;return!(Math.abs(this.tangentU.magnitude()-1)>t||Math.abs(this.tangentV.magnitude()-1)>t||Math.abs(this.normal.magnitude()-1)>t)&&!(Math.abs(h.dot(this.tangentU,this.tangentV))>t||Math.abs(h.dot(this.tangentU,this.normal))>t||Math.abs(h.dot(this.tangentV,this.normal))>t)}}class o{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;this.controlPoints=void 0,this.uKnots=void 0,this.vKnots=void 0,this.uDegree=void 0,this.vDegree=void 0;const i=t.length-1,n=t[0].length-1;this.uDegree=Math.min(e,i),this.vDegree=Math.min(s,n);const h=this.createKnotsAndDegree(t,this.uDegree,this.vDegree);this.init(t,h.uKnots,h.vKnots,this.uDegree,this.vDegree)}init(t,e,s,i,n){this.controlPoints=t,this.uKnots=e,this.vKnots=s,this.uDegree=i,this.vDegree=n}basisFunction(t,e,s,i){if(0===e)return s[i]<=t&&t<s[i+1]||Math.abs(t-s[i+1])<1e-10&&i===s.length-2?1:0;const n=s[i+e]-s[i],h=s[i+e+1]-s[i+1];return(0!==n?(t-s[i])/n*this.basisFunction(t,e-1,s,i):0)+(0!==h?(s[i+e+1]-t)/h*this.basisFunction(t,e-1,s,i+1):0)}calculateFrame(t,e){const s=1e-7,i=this.evaluate(t,e),n=this.evaluate(t+s,e),o=this.evaluate(t,e+s),a=h.scale(h.subtract(n,i),1/s).normalize(),l=h.scale(h.subtract(o,i),1/s).normalize();if(a.isZero()){const t=new h(1,0,0),e=h.dot(t,l);a.x=t.x-e*l.x,a.y=t.y-e*l.y,a.z=t.z-e*l.z}if(l.isZero()){const t=new h(0,1,0),e=h.dot(t,a);l.x=t.x-e*a.x,l.y=t.y-e*a.y,l.z=t.z-e*a.z}const c=new r(i,a,l,h.cross(a,l).normalize());if(!c.isValid())throw new Error("Invalid frame generated");return c}calculateFrameWithBinormal(t,e){const s=this.calculateFrame(t,e);return{frame:s,binormal:h.cross(s.normal,s.tangentU).normalize()}}evaluate(t,e){t=Math.max(0,Math.min(1,t)),e=Math.max(0,Math.min(1,e));let s=0,i=0,n=0,r=0;const o=this.findSpan(t,this.uDegree,this.uKnots),a=this.findSpan(e,this.vDegree,this.vKnots),l=new Array(this.uDegree+1).fill(0),c=new Array(this.vDegree+1).fill(0);for(let h=0;h<=this.uDegree;h++)l[h]=this.basisFunction(t,this.uDegree,this.uKnots,o-this.uDegree+h);for(let h=0;h<=this.vDegree;h++)c[h]=this.basisFunction(e,this.vDegree,this.vKnots,a-this.vDegree+h);for(let h=0;h<=this.uDegree;h++){const t=o-this.uDegree+h;if(!(t<0||t>=this.controlPoints.length))for(let e=0;e<=this.vDegree;e++){const o=a-this.vDegree+e;if(o<0||o>=this.controlPoints[0].length)continue;const d=l[h]*c[e],u=this.controlPoints[t][o];s+=d*u.x,i+=d*u.y,n+=d*u.z,r+=d}}if(Math.abs(r)<1e-10){const s=Math.floor(t*(this.controlPoints.length-1)),i=Math.floor(e*(this.controlPoints[0].length-1));return this.controlPoints[s][i]}return new h(s/r,i/r,n/r)}findSpan(t,e,s){const i=s.length-e-2;if(Math.abs(t-s[i+1])<1e-10)return i;if(t<s[e])return e;let n=e,h=i+1,r=Math.floor((n+h)/2);for(;t<s[r]||t>=s[r+1];)if(t<s[r]?h=r:n=r,r=Math.floor((n+h)/2),n>=h)return Math.min(i,r);return r}createKnotsAndDegree(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;const i=t.length,n=t[0].length,h=(t,e)=>{const s=[],i=t+e+1;for(let h=0;h<=e;h++)s.push(0);const n=i-2*(e+1);for(let h=1;h<=n+1;h++)s.push(h/(n+1));for(let h=0;h<=e;h++)s.push(1);return s};(i<=e||n<=s)&&(e=Math.min(i-1,n-1),console.warn("Degree reduced to ".concat(e," due to insufficient control points")));return{uKnots:h(i,e),vKnots:h(n,s),uDegree:e,vDegree:s}}normal(t,e){const s=this.evaluate(t,e),i=this.evaluate(t+.01,e),n=this.evaluate(t,e+.01),r=h.subtract(i,s),o=h.subtract(n,s);return h.cross(r,o).normalize()}curvature(t,e){const s=.01,i=this.evaluate(t,e),n=this.evaluate(t+s,e),r=this.evaluate(t,e+s),o=h.subtract(n,i).magnitude(),a=h.subtract(r,i).magnitude();return Math.abs(o-a)/s}}class a{constructor(t){this.div=void 0,this.renderer=void 0,this.vecs=[],this.cps=[],this.pts=[],this.lns=[],this.polylines=[],this.circle=[],this.t=0,this.tVal=0,this.surface=void 0,this.N=3,this.uSeg=20,this.vSeg=20,this.u=0,this.v=0,this.div=document.getElementById(t);const e=document.createElement("div");e.style.position="absolute",this.div.appendChild(e);let s=(0,n.D)("N",1,3);s.slider.defaultValue="".concat(this.N),s.slider.addEventListener("input",(t=>{const e=+t.target.value;this.N=e,this.removeAll(),this.init()})),e.appendChild(s.div);let h=(0,n.V)("show frame");h.checkBox.defaultChecked=!1,h.checkBox.onchange=()=>{this.renderer.showFrame=h.checkBox.checked},e.appendChild(h.div);let r=(0,n.V)("show vertex");r.checkBox.defaultChecked=!0,r.checkBox.onchange=()=>{!0===r.checkBox.checked?this.renderer.showPoint=!0:this.renderer.showPoint=!1},e.appendChild(r.div),s=(0,n.D)("U seg",1,25),s.slider.defaultValue="".concat(this.uSeg),s.slider.addEventListener("input",(t=>{const e=+t.target.value;this.uSeg=e,this.removeAll(),this.init()})),e.appendChild(s.div),s=(0,n.D)("V seg",1,25),s.slider.defaultValue="".concat(this.vSeg),s.slider.addEventListener("input",(t=>{const e=+t.target.value;this.vSeg=e,this.removeAll(),this.init()})),e.appendChild(s.div),s=(0,n.D)("u",0,99),s.slider.defaultValue="".concat(this.vSeg),s.slider.addEventListener("input",(t=>{const e=+t.target.value;this.u=.01*e,this.removeAll(),this.init()})),e.appendChild(s.div),s=(0,n.D)("v",0,99),s.slider.defaultValue="".concat(this.vSeg),s.slider.addEventListener("input",(t=>{const e=+t.target.value;this.v=.01*e,this.removeAll(),this.init()})),e.appendChild(s.div),this.renderer=new i.n(t),this.renderer.pts=this.pts,this.renderer.vecs=this.vecs,this.renderer.cps=this.cps,this.renderer.circle=this.circle,this.renderer.polylines=this.polylines,this.init(),this.update(),this.render()}init(){const t=[[new h(0,-200,-200),new h(100,0,100),new h(200,0,0)],[new h(0,100,100),new h(100,100,200),new h(200,100,100)],[new h(0,200,0),new h(100,200,100),new h(200,200,0)]],e=new o(t,this.N,this.N),s=1/this.uSeg,i=1/this.vSeg;for(let o=0;o<1;o+=i)for(let t=0;t<1;t+=s){const s=e.evaluate(o,t),i=s.x,n=s.y,r=s.z,a=new h(i,n,r);a.size=2,this.pts.push(a);const l=e.calculateFrame(o,t);this.vecs.push([s,h.add(s,h.scale(l.tangentU,10))]),this.vecs.push([s,h.add(s,h.scale(l.tangentV,10))]),this.vecs.push([s,h.add(s,h.scale(l.normal,10))])}let n=e.evaluate(this.u,this.v);n.size=4,this.pts.push(n);const r=[];for(let h=0;h<1;h+=s){let t=e.evaluate(h,this.v);r.push(t)}this.polylines.push(r);const a=[];for(let h=0;h<1;h+=i){let t=e.evaluate(this.u,h);a.push(t)}this.polylines.push(a)}removeAll(){this.cps.length=0,this.pts.length=0,this.vecs.length=0,this.circle.length=0,this.polylines.length=0}update(){for(let t=0;t<this.pts.length;++t);this.t+=.01}render(){requestAnimationFrame((()=>{this.render()})),this.update(),this.renderer.render()}destroy(){try{for(;this.div&&this.div.lastElementChild;){const t=this.div.lastElementChild;this.div.removeChild(t)}}catch(t){console.error("Error removing child elements:",t)}}}}}]);
//# sourceMappingURL=26309.4bbd04e2.chunk.js.map
"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[34260],{34260:(e,t,n)=>{n.d(t,{ZP:()=>bs});var s={};n.r(s),n.d(s,{APIConnectionError:()=>R,APIConnectionTimeoutError:()=>I,APIError:()=>S,APIUserAbortError:()=>x,AuthenticationError:()=>T,BadRequestError:()=>C,ConflictError:()=>M,InternalServerError:()=>F,NotFoundError:()=>k,OpenAIError:()=>P,PermissionDeniedError:()=>O,RateLimitError:()=>B,UnprocessableEntityError:()=>j});var r=n(18489),i=n(83738),o=n(74269),a=n(60715),l=n(3206);const c="4.47.1";let u,h,d,f,p,m,v,g,y,w=!1,_=null,b=null,Z=null,A=null;class E{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}u||function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{auto:!1};if(w)throw new Error("you must `import 'openai/shims/".concat(e.kind,"'` before importing anything else from openai"));if(u)throw new Error("can't `import 'openai/shims/".concat(e.kind,"'` after `import 'openai/shims/").concat(u,"'`"));w=t.auto,u=e.kind,h=e.fetch,_=e.Request,b=e.Response,Z=e.Headers,d=e.FormData,A=e.Blob,f=e.File,p=e.ReadableStream,m=e.getMultipartRequestOptions,v=e.getDefaultAgent,g=e.fileFromPath,y=e.isFsReadStream}(function(){let{manuallyImported:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,s,i,o;try{n=fetch,s=Request,i=Response,o=Headers}catch(a){throw new Error("this environment is missing the following Web Fetch API type: ".concat(a.message,". ").concat(t))}return{kind:"web",fetch:n,Request:s,Response:i,Headers:o,FormData:"undefined"!==typeof FormData?FormData:class{constructor(){throw new Error("file uploads aren't supported in this environment yet as 'FormData' is undefined. ".concat(t))}},Blob:"undefined"!==typeof Blob?Blob:class{constructor(){throw new Error("file uploads aren't supported in this environment yet as 'Blob' is undefined. ".concat(t))}},File:"undefined"!==typeof File?File:class{constructor(){throw new Error("file uploads aren't supported in this environment yet as 'File' is undefined. ".concat(t))}},ReadableStream:"undefined"!==typeof ReadableStream?ReadableStream:class{constructor(){throw new Error("streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ".concat(t))}},getMultipartRequestOptions:async(e,t)=>(0,r.Z)((0,r.Z)({},t),{},{body:new E(e)}),getDefaultAgent:e=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:e=>!1}}(),{auto:!0});class P extends Error{}class S extends P{constructor(e,t,n,s){super("".concat(S.makeMessage(e,t,n))),this.status=e,this.headers=s,this.request_id=null===s||void 0===s?void 0:s["x-request-id"];const r=t;this.error=r,this.code=null===r||void 0===r?void 0:r.code,this.param=null===r||void 0===r?void 0:r.param,this.type=null===r||void 0===r?void 0:r.type}static makeMessage(e,t,n){const s=null!==t&&void 0!==t&&t.message?"string"===typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&s?"".concat(e," ").concat(s):e?"".concat(e," status code (no body)"):s||"(no status code or body)"}static generate(e,t,n,s){if(!e)return new R({cause:Ee(t)});const r=null===t||void 0===t?void 0:t.error;return 400===e?new C(e,r,n,s):401===e?new T(e,r,n,s):403===e?new O(e,r,n,s):404===e?new k(e,r,n,s):409===e?new M(e,r,n,s):422===e?new j(e,r,n,s):429===e?new B(e,r,n,s):e>=500?new F(e,r,n,s):new S(e,r,n,s)}}class x extends S{constructor(){let{message:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class R extends S{constructor(e){let{message:t,cause:n}=e;super(void 0,void 0,t||"Connection error.",void 0),this.status=void 0,n&&(this.cause=n)}}class I extends R{constructor(){let{message:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({message:null!==e&&void 0!==e?e:"Request timed out."})}}class C extends S{constructor(){super(...arguments),this.status=400}}class T extends S{constructor(){super(...arguments),this.status=401}}class O extends S{constructor(){super(...arguments),this.status=403}}class k extends S{constructor(){super(...arguments),this.status=404}}class M extends S{constructor(){super(...arguments),this.status=409}}class j extends S{constructor(){super(...arguments),this.status=422}}class B extends S{constructor(){super(...arguments),this.status=429}}class F extends S{}class N{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;function s(){return s=(0,l.Z)((function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let s=!1;try{var r,i=!1,l=!1;try{for(var c,u=(0,o.Z)(function(e,t){return D.apply(this,arguments)}(e,t));i=!(c=yield(0,a.Z)(u.next())).done;i=!1){const e=c.value;if(!s)if(e.data.startsWith("[DONE]"))s=!0;else if(null===e.event){let t;try{t=JSON.parse(e.data)}catch(h){throw console.error("Could not parse message into JSON:",e.data),console.error("From chunk:",e.raw),h}if(t&&t.error)throw new S(void 0,t.error,void 0,void 0);yield t}else{let t;try{t=JSON.parse(e.data)}catch(h){throw console.error("Could not parse message into JSON:",e.data),console.error("From chunk:",e.raw),h}if("error"==e.event)throw new S(void 0,t.error,t.message,void 0);yield{event:e.event,data:t}}}}catch(d){l=!0,r=d}finally{try{i&&null!=u.return&&(yield(0,a.Z)(u.return()))}finally{if(l)throw r}}s=!0}catch(h){if(h instanceof Error&&"AbortError"===h.name)return;throw h}finally{s||t.abort()}})),s.apply(this,arguments)}return new N((function(){return s.apply(this,arguments)}),t)}static fromReadableStream(e,t){let n=!1;function s(){return(s=(0,l.Z)((function*(){const t=new U,n=X(e);var s,r=!1,i=!1;try{for(var l,c=(0,o.Z)(n);r=!(l=yield(0,a.Z)(c.next())).done;r=!1){const e=l.value;for(const n of t.decode(e))yield n}}catch(u){i=!0,s=u}finally{try{r&&null!=c.return&&(yield(0,a.Z)(c.return()))}finally{if(i)throw s}}for(const e of t.flush())yield e}))).apply(this,arguments)}function r(){return r=(0,l.Z)((function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let e=!1;try{var r,i=!1,l=!1;try{for(var c,u=(0,o.Z)(function(){return s.apply(this,arguments)}());i=!(c=yield(0,a.Z)(u.next())).done;i=!1){const t=c.value;e||t&&(yield JSON.parse(t))}}catch(h){l=!0,r=h}finally{try{i&&null!=u.return&&(yield(0,a.Z)(u.return()))}finally{if(l)throw r}}e=!0}catch(d){if(d instanceof Error&&"AbortError"===d.name)return;throw d}finally{e||t.abort()}})),r.apply(this,arguments)}return new N((function(){return r.apply(this,arguments)}),t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),s=s=>({next:()=>{if(0===s.length){const s=n.next();e.push(s),t.push(s)}return s.shift()}});return[new N((()=>s(e)),this.controller),new N((()=>s(t)),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new p({async start(){t=e[Symbol.asyncIterator]()},async pull(e){try{const{value:s,done:r}=await t.next();if(r)return e.close();const i=n.encode(JSON.stringify(s)+"\n");e.enqueue(i)}catch(s){e.error(s)}},async cancel(){var e,n;await(null===(e=(n=t).return)||void 0===e?void 0:e.call(n))}})}}function D(){return D=(0,l.Z)((function*(e,t){if(!e.body)throw t.abort(),new P("Attempted to iterate over a response with no body");const n=new q,s=new U,r=X(e.body);var i,l=!1,c=!1;try{for(var u,h=(0,o.Z)(function(e){return L.apply(this,arguments)}(r));l=!(u=yield(0,a.Z)(h.next())).done;l=!1){const e=u.value;for(const t of s.decode(e)){const e=n.decode(t);e&&(yield e)}}}catch(d){c=!0,i=d}finally{try{l&&null!=h.return&&(yield(0,a.Z)(h.return()))}finally{if(c)throw i}}for(const o of s.flush()){const e=n.decode(o);e&&(yield e)}})),D.apply(this,arguments)}function L(){return(L=(0,l.Z)((function*(e){let t=new Uint8Array;var n,s=!1,r=!1;try{for(var i,l=(0,o.Z)(e);s=!(i=yield(0,a.Z)(l.next())).done;s=!1){const e=i.value;{if(null==e)continue;const n=e instanceof ArrayBuffer?new Uint8Array(e):"string"===typeof e?(new TextEncoder).encode(e):e;let s,r=new Uint8Array(t.length+n.length);for(r.set(t),r.set(n,t.length),t=r;-1!==(s=W(t));)yield t.slice(0,s),t=t.slice(s)}}}catch(c){r=!0,n=c}finally{try{s&&null!=l.return&&(yield(0,a.Z)(l.return()))}finally{if(r)throw n}}t.length>0&&(yield t)}))).apply(this,arguments)}function W(e){for(let t=0;t<e.length-2;t++){if(10===e[t]&&10===e[t+1])return t+2;if(13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return-1}class q{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,s]=function(e,t){const n=e.indexOf(t);if(-1!==n)return[e.substring(0,n),t,e.substring(n+t.length)];return[e,"",""]}(e,":");return s.startsWith(" ")&&(s=s.substring(1)),"event"===t?this.event=s:"data"===t&&this.data.push(s),null}}class U{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const n=U.NEWLINE_CHARS.has(t[t.length-1]||"");let s=t.split(U.NEWLINE_REGEXP);return n&&s.pop(),1!==s.length||n?(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),n||(this.buffer=[s.pop()||""]),s):(this.buffer.push(s[0]),[])}decodeText(e){if(null==e)return"";if("string"===typeof e)return e;if("undefined"!==typeof Buffer){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new P("Unexpected: received non-Uint8Array (".concat(e.constructor.name,') stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.'))}if("undefined"!==typeof TextDecoder){var t;if(e instanceof Uint8Array||e instanceof ArrayBuffer)return null!==(t=this.textDecoder)&&void 0!==t||(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new P("Unexpected: received non-Uint8Array/ArrayBuffer (".concat(e.constructor.name,") in a web platform. Please report this error."))}throw new P("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}function X(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();return null!==e&&void 0!==e&&e.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}U.NEWLINE_CHARS=new Set(["\n","\r"]),U.NEWLINE_REGEXP=/\r\n|[\n\r]/g;const J=e=>null!=e&&"object"===typeof e&&"string"===typeof e.url&&"function"===typeof e.blob,H=e=>null!=e&&"object"===typeof e&&"string"===typeof e.name&&"number"===typeof e.lastModified&&K(e),K=e=>null!=e&&"object"===typeof e&&"number"===typeof e.size&&"string"===typeof e.type&&"function"===typeof e.text&&"function"===typeof e.slice&&"function"===typeof e.arrayBuffer,V=e=>H(e)||J(e)||y(e);async function Y(e,t,n){var s,i;if(e=await e,null!==(s=n)&&void 0!==s||(n=H(e)?{lastModified:e.lastModified,type:e.type}:{}),J(e)){var a;const s=await e.blob();return t||(t=null!==(a=new URL(e.url).pathname.split(/[\\/]/).pop())&&void 0!==a?a:"unknown_file"),new f([s],t,n)}const l=await async function(e){let t=[];if("string"===typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(K(e))t.push(await e.arrayBuffer());else{var n;if(!z(e))throw new Error("Unexpected data type: ".concat(typeof e,"; constructor: ").concat(null===e||void 0===e||null===(n=e.constructor)||void 0===n?void 0:n.name,"; props: ").concat(function(e){const t=Object.getOwnPropertyNames(e);return"[".concat(t.map((e=>'"'.concat(e,'"'))).join(", "),"]")}(e)));var s,r=!1,i=!1;try{for(var a,l=(0,o.Z)(e);r=!(a=await l.next()).done;r=!1){const e=a.value;t.push(e)}}catch(c){i=!0,s=c}finally{try{r&&null!=l.return&&await l.return()}finally{if(i)throw s}}}return t}(e);if(t||(t=null!==(i=function(e){var t;return G(e.name)||G(e.filename)||(null===(t=G(e.path))||void 0===t?void 0:t.split(/[\\/]/).pop())}(e))&&void 0!==i?i:"unknown_file"),!n.type){var c;const e=null===(c=l[0])||void 0===c?void 0:c.type;"string"===typeof e&&(n=(0,r.Z)((0,r.Z)({},n),{},{type:e}))}return new f(l,t,n)}const G=e=>"string"===typeof e?e:"undefined"!==typeof Buffer&&e instanceof Buffer?String(e):void 0,z=e=>null!=e&&"object"===typeof e&&"function"===typeof e[Symbol.asyncIterator],Q=e=>e&&"object"===typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag],$=async e=>{const t=await ee(e.body);return m(t,e)},ee=async e=>{const t=new d;return await Promise.all(Object.entries(e||{}).map((e=>{let[n,s]=e;return te(t,n,s)}))),t},te=async(e,t,n)=>{if(void 0!==n){if(null==n)throw new TypeError('Received null for "'.concat(t,"\"; to pass null in FormData, you must use the string 'null'"));if("string"===typeof n||"number"===typeof n||"boolean"===typeof n)e.append(t,String(n));else if(V(n)){const s=await Y(n);e.append(t,s)}else if(Array.isArray(n))await Promise.all(n.map((n=>te(e,t+"[]",n))));else{if("object"!==typeof n)throw new TypeError("Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ".concat(n," instead"));await Promise.all(Object.entries(n).map((n=>{let[s,r]=n;return te(e,"".concat(t,"[").concat(s,"]"),r)})))}}},ne=["signal"];var se,re=function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},ie=function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};async function oe(e){const{response:t}=e;if(e.options.stream)return Ie("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):N.fromSSEResponse(t,e.controller);if(204===t.status)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type");if((null===n||void 0===n?void 0:n.includes("application/json"))||(null===n||void 0===n?void 0:n.includes("application/vnd.api+json"))){const e=await t.json();return Ie("response",t.status,t.url,t.headers,e),e}const s=await t.text();return Ie("response",t.status,t.url,t.headers,s),s}class ae extends Promise{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oe;super((e=>{e(null)})),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new ae(this.responsePromise,(async t=>e(await this.parseResponse(t))))}asResponse(){return this.responsePromise.then((e=>e.response))}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class le{constructor(e){let{baseURL:t,maxRetries:n=2,timeout:s=6e5,httpAgent:r,fetch:i}=e;this.baseURL=t,this.maxRetries=Ae("maxRetries",n),this.timeout=Ae("timeout",s),this.httpAgent=r,this.fetch=null!==i&&void 0!==i?i:h}authHeaders(e){return{}}defaultHeaders(e){return(0,r.Z)((0,r.Z)({Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent()},ye()),this.authHeaders(e))}validateHeaders(e,t){}defaultIdempotencyKey(){return"stainless-node-retry-".concat(Ce())}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then((n=>(0,r.Z)({method:e,path:t},n))))}getAPIList(e,t,n){return this.requestAPIList(t,(0,r.Z)({method:"get",path:e},n))}calculateContentLength(e){if("string"===typeof e){if("undefined"!==typeof Buffer)return Buffer.byteLength(e,"utf8").toString();if("undefined"!==typeof TextEncoder){return(new TextEncoder).encode(e).length.toString()}}return null}buildRequest(e){var t,n,s,i,o,a;const{method:l,path:c,query:u,headers:h={}}=e,d=Q(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,f=this.calculateContentLength(d),p=this.buildURL(c,u);"timeout"in e&&Ae("timeout",e.timeout);const m=null!==(t=e.timeout)&&void 0!==t?t:this.timeout,g=null!==(n=null!==(s=e.httpAgent)&&void 0!==s?s:this.httpAgent)&&void 0!==n?n:v(p),y=m+1e3;"number"===typeof(null===g||void 0===g||null===(i=g.options)||void 0===i?void 0:i.timeout)&&y>(null!==(o=g.options.timeout)&&void 0!==o?o:0)&&(g.options.timeout=y),this.idempotencyHeader&&"get"!==l&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),h[this.idempotencyHeader]=e.idempotencyKey);const w=this.buildHeaders({options:e,headers:h,contentLength:f});return{req:(0,r.Z)((0,r.Z)((0,r.Z)({method:l},d&&{body:d}),{},{headers:w},g&&{agent:g}),{},{signal:null!==(a=e.signal)&&void 0!==a?a:null}),url:p,timeout:m}}buildHeaders(e){let{options:t,headers:n,contentLength:s}=e;const r={};s&&(r["content-length"]=s);return Re(r,this.defaultHeaders(t)),Re(r,n),Q(t.body)&&"node"!==u&&delete r["content-type"],this.validateHeaders(r,n),r}async prepareOptions(e){}async prepareRequest(e,t){let{url:n,options:s}=t}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map((e=>[...e]))):(0,r.Z)({},e):{}}makeStatusError(e,t,n,s){return S.generate(e,t,n,s)}request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new ae(this.makeRequest(e,t))}async makeRequest(e,t){var n;const s=await e;var r;null==t&&(t=null!==(r=s.maxRetries)&&void 0!==r?r:this.maxRetries);await this.prepareOptions(s);const{req:i,url:o,timeout:a}=this.buildRequest(s);if(await this.prepareRequest(i,{url:o,options:s}),Ie("request",o,s,i.headers),null!==(n=s.signal)&&void 0!==n&&n.aborted)throw new x;const l=new AbortController,c=await this.fetchWithTimeout(o,i,a,l).catch(Ee);if(c instanceof Error){var u;if(null!==(u=s.signal)&&void 0!==u&&u.aborted)throw new x;if(t)return this.retryRequest(s,t);if("AbortError"===c.name)throw new I;throw new R({cause:c})}const h=he(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const e="retrying, ".concat(t," attempts remaining");return Ie("response (error; ".concat(e,")"),c.status,o,h),this.retryRequest(s,t,h)}const e=await c.text().catch((e=>Ee(e).message)),n=we(e),r=n?void 0:e;Ie("response (error; ".concat(t?"(error; no more retries left)":"(error; not retryable)",")"),c.status,o,h,r);throw this.makeStatusError(c.status,n,r,h)}return{response:c,options:s,controller:l}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new ue(this,n,e)}buildURL(e,t){const n=be(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return Se(s)||(t=(0,r.Z)((0,r.Z)({},s),t)),"object"===typeof t&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter((e=>{let[t,n]=e;return"undefined"!==typeof n})).map((e=>{let[t,n]=e;if("string"===typeof n||"number"===typeof n||"boolean"===typeof n)return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n));if(null===n)return"".concat(encodeURIComponent(t),"=");throw new P("Cannot stringify type ".concat(typeof n,"; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case."))})).join("&")}async fetchWithTimeout(e,t,n,s){const o=t||{},{signal:a}=o,l=(0,i.Z)(o,ne);a&&a.addEventListener("abort",(()=>s.abort()));const c=setTimeout((()=>s.abort()),n);return this.getRequestClient().fetch.call(void 0,e,(0,r.Z)({signal:s.signal},l)).finally((()=>{clearTimeout(c)}))}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||(409===e.status||(429===e.status||e.status>=500)))}async retryRequest(e,t,n){let s;const r=null===n||void 0===n?void 0:n["retry-after-ms"];if(r){const e=parseFloat(r);Number.isNaN(e)||(s=e)}const i=null===n||void 0===n?void 0:n["retry-after"];if(i&&!s){const e=parseFloat(i);s=Number.isNaN(e)?Date.parse(i)-Date.now():1e3*e}if(!(s&&0<=s&&s<6e4)){var o;const n=null!==(o=e.maxRetries)&&void 0!==o?o:this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,n)}return await Ze(s),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const n=t-e;return Math.min(.5*Math.pow(2,n),8)*(1-.25*Math.random())*1e3}getUserAgent(){return"".concat(this.constructor.name,"/JS ").concat(c)}}class ce{constructor(e,t,n,s){se.set(this,void 0),re(this,se,e,"f"),this.options=s,this.response=t,this.body=n}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new P("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t=(0,r.Z)({},this.options);if("params"in e&&"object"===typeof t.query)t.query=(0,r.Z)((0,r.Z)({},t.query),e.params);else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[t,s]of n)e.url.searchParams.set(t,s);t.query=void 0,t.path=e.url.toString()}return await ie(this,se,"f").requestAPIList(this.constructor,t)}iterPages(){var e=this;return(0,l.Z)((function*(){let t=e;for(yield t;t.hasNextPage();)t=yield(0,a.Z)(t.getNextPage()),yield t}))()}[(se=new WeakMap,Symbol.asyncIterator)](){var e=this;return(0,l.Z)((function*(){var t,n=!1,s=!1;try{for(var r,i=(0,o.Z)(e.iterPages());n=!(r=yield(0,a.Z)(i.next())).done;n=!1){const e=r.value;for(const t of e.getPaginatedItems())yield t}}catch(l){s=!0,t=l}finally{try{n&&null!=i.return&&(yield(0,a.Z)(i.return()))}finally{if(s)throw t}}}))()}}class ue extends ae{constructor(e,t,n){super(t,(async t=>new n(e,t.response,await oe(t),t.options)))}[Symbol.asyncIterator](){var e=this;return(0,l.Z)((function*(){const t=yield(0,a.Z)(e);var n,s=!1,r=!1;try{for(var i,l=(0,o.Z)(t);s=!(i=yield(0,a.Z)(l.next())).done;s=!1){const e=i.value;yield e}}catch(c){r=!0,n=c}finally{try{s&&null!=l.return&&(yield(0,a.Z)(l.return()))}finally{if(r)throw n}}}))()}}const he=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),de={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryResponse:!0,__streamClass:!0},fe=e=>"object"===typeof e&&null!==e&&!Se(e)&&Object.keys(e).every((e=>xe(de,e))),pe=()=>{var e,t;if("undefined"!==typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":c,"X-Stainless-OS":ve(Deno.build.os),"X-Stainless-Arch":me(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"===typeof Deno.version?Deno.version:null!==(e=null===(t=Deno.version)||void 0===t?void 0:t.deno)&&void 0!==e?e:"unknown"};if("undefined"!==typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":c,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"other:".concat(EdgeRuntime),"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!==typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":c,"X-Stainless-OS":ve(process.platform),"X-Stainless-Arch":me(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const n=function(){if("undefined"===typeof navigator||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const e=n.exec(navigator.userAgent);if(e){const n=e[1]||0,s=e[2]||0,r=e[3]||0;return{browser:t,version:"".concat(n,".").concat(s,".").concat(r)}}}return null}();return n?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":c,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"browser:".concat(n.browser),"X-Stainless-Runtime-Version":n.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":c,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};const me=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?"other:".concat(e):"unknown",ve=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?"Other:".concat(e):"Unknown";let ge;const ye=()=>{var e;return null!==(e=ge)&&void 0!==e?e:ge=pe()},we=e=>{try{return JSON.parse(e)}catch(t){return}},_e=new RegExp("^(?:[a-z]+:)?//","i"),be=e=>_e.test(e),Ze=e=>new Promise((t=>setTimeout(t,e))),Ae=(e,t)=>{if("number"!==typeof t||!Number.isInteger(t))throw new P("".concat(e," must be an integer"));if(t<0)throw new P("".concat(e," must be a positive integer"));return t},Ee=e=>e instanceof Error?e:new Error(e),Pe=e=>{var t,n,s,r,i,o;return"undefined"!==typeof process?null!==(t=null===(n={NODE_ENV:"production",PUBLIC_URL:"/njs-lab-public",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_OPEN_WEATHER_MAP_API_KEY:"bd30a8d327da510a2972cbbec887a1e2",REACT_APP_YOUTUBE_API_KEY:"AIzaSyAJmm-IhVl-84KQ0CSAK5Ka03dFBV2hhCs",REACT_APP_FIREBASE_API_KEY:"AIzaSyAsGNHXVPsIjOJA5eY5XY8sLEF11ispMJg",REACT_APP_FIREBASE_DOMAIN:"njs-lab.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"njs-lab",REACT_APP_FIREBASE_STORAGE_BUCKET:"njs-lab.appspot.com",REACT_APP_FIREBASE_MEASUREMENT_SENDER_ID:"438027774199",REACT_APP_FIREBASE_APP_ID:"1:438027774199:web:d12c3a33744a9d411a8bf2",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-VH51C7700D",REACT_APP_MAPBOX:"pk.eyJ1IjoiZGVzaWduanUiLCJhIjoiY2xhNGU0YWo4MDlhYzNwdHBwenVvang4eiJ9.P3sX4l_3KjdPeRRbVS1VVg",REACT_APP_GOOGLE_AI_STUDIO_KEY:"AIzaSyAC1CnqJgLitf9SkJpECyYT4-t7OqeL_hw",REACT_APP_OPEN_AI_CHAT_GPT:"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",REACT_APP_DEEP_L:"b5fccb05-709f-43fd-9d40-ed692abab4fa:fx"})||void 0===n||null===(s=n[e])||void 0===s?void 0:s.trim())&&void 0!==t?t:void 0:"undefined"!==typeof Deno?null===(r=Deno.env)||void 0===r||null===(i=r.get)||void 0===i||null===(o=i.call(r,e))||void 0===o?void 0:o.trim():void 0};function Se(e){if(!e)return!0;for(const t in e)return!1;return!0}function xe(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Re(e,t){for(const n in t){if(!xe(t,n))continue;const s=n.toLowerCase();if(!s)continue;const r=t[n];null===r?delete e[s]:void 0!==r&&(e[s]=r)}}function Ie(e){var t,n;if("undefined"!==typeof process&&"true"===(null===(t=process)||void 0===t||null===(n={NODE_ENV:"production",PUBLIC_URL:"/njs-lab-public",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_OPEN_WEATHER_MAP_API_KEY:"bd30a8d327da510a2972cbbec887a1e2",REACT_APP_YOUTUBE_API_KEY:"AIzaSyAJmm-IhVl-84KQ0CSAK5Ka03dFBV2hhCs",REACT_APP_FIREBASE_API_KEY:"AIzaSyAsGNHXVPsIjOJA5eY5XY8sLEF11ispMJg",REACT_APP_FIREBASE_DOMAIN:"njs-lab.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"njs-lab",REACT_APP_FIREBASE_STORAGE_BUCKET:"njs-lab.appspot.com",REACT_APP_FIREBASE_MEASUREMENT_SENDER_ID:"438027774199",REACT_APP_FIREBASE_APP_ID:"1:438027774199:web:d12c3a33744a9d411a8bf2",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-VH51C7700D",REACT_APP_MAPBOX:"pk.eyJ1IjoiZGVzaWduanUiLCJhIjoiY2xhNGU0YWo4MDlhYzNwdHBwenVvang4eiJ9.P3sX4l_3KjdPeRRbVS1VVg",REACT_APP_GOOGLE_AI_STUDIO_KEY:"AIzaSyAC1CnqJgLitf9SkJpECyYT4-t7OqeL_hw",REACT_APP_OPEN_AI_CHAT_GPT:"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",REACT_APP_DEEP_L:"b5fccb05-709f-43fd-9d40-ed692abab4fa:fx"})||void 0===n?void 0:n.DEBUG)){for(var s=arguments.length,r=new Array(s>1?s-1:0),i=1;i<s;i++)r[i-1]=arguments[i];console.log("OpenAI:DEBUG:".concat(e),...r)}}const Ce=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));function Te(e){return null!=e&&"object"===typeof e&&!Array.isArray(e)}class Oe extends ce{constructor(e,t,n,s){super(e,t,n,s),this.data=n.data||[],this.object=n.object}getPaginatedItems(){var e;return null!==(e=this.data)&&void 0!==e?e:[]}nextPageParams(){return null}nextPageInfo(){return null}}class ke extends ce{constructor(e,t,n,s){super(e,t,n,s),this.data=n.data||[]}getPaginatedItems(){var e;return null!==(e=this.data)&&void 0!==e?e:[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var e;const t=this.getPaginatedItems();if(!t.length)return null;const n=null===(e=t[t.length-1])||void 0===e?void 0:e.id;return n?{params:{after:n}}:null}}class Me{constructor(e){this._client=e}}class je extends Me{create(e,t){var n;return this._client.post("/completions",(0,r.Z)((0,r.Z)({body:e},t),{},{stream:null!==(n=e.stream)&&void 0!==n&&n}))}}je||(je={});class Be extends Me{create(e,t){var n;return this._client.post("/chat/completions",(0,r.Z)((0,r.Z)({body:e},t),{},{stream:null!==(n=e.stream)&&void 0!==n&&n}))}}Be||(Be={});class Fe extends Me{constructor(){super(...arguments),this.completions=new Be(this._client)}}!function(e){e.Completions=Be}(Fe||(Fe={}));class Ne extends Me{create(e,t){return this._client.post("/embeddings",(0,r.Z)({body:e},t))}}Ne||(Ne={});class De extends Me{create(e,t){return this._client.post("/files",$((0,r.Z)({body:e},t)))}retrieve(e,t){return this._client.get("/files/".concat(e),t)}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return fe(e)?this.list({},e):this._client.getAPIList("/files",Le,(0,r.Z)({query:e},t))}del(e,t){return this._client.delete("/files/".concat(e),t)}content(e,t){return this._client.get("/files/".concat(e,"/content"),(0,r.Z)((0,r.Z)({},t),{},{__binaryResponse:!0}))}retrieveContent(e,t){return this._client.get("/files/".concat(e,"/content"),(0,r.Z)((0,r.Z)({},t),{},{headers:(0,r.Z)({Accept:"application/json"},null===t||void 0===t?void 0:t.headers)}))}async waitForProcessing(e){let{pollInterval:t=5e3,maxWait:n=18e5}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=new Set(["processed","error","deleted"]),r=Date.now();let i=await this.retrieve(e);for(;!i.status||!s.has(i.status);)if(await Ze(t),i=await this.retrieve(e),Date.now()-r>n)throw new I({message:"Giving up on waiting for file ".concat(e," to finish processing after ").concat(n," milliseconds.")});return i}}class Le extends Oe{}!function(e){e.FileObjectsPage=Le}(De||(De={}));class We extends Me{createVariation(e,t){return this._client.post("/images/variations",$((0,r.Z)({body:e},t)))}edit(e,t){return this._client.post("/images/edits",$((0,r.Z)({body:e},t)))}generate(e,t){return this._client.post("/images/generations",(0,r.Z)({body:e},t))}}We||(We={});class qe extends Me{create(e,t){return this._client.post("/audio/speech",(0,r.Z)((0,r.Z)({body:e},t),{},{__binaryResponse:!0}))}}qe||(qe={});class Ue extends Me{create(e,t){return this._client.post("/audio/transcriptions",$((0,r.Z)({body:e},t)))}}Ue||(Ue={});class Xe extends Me{create(e,t){return this._client.post("/audio/translations",$((0,r.Z)({body:e},t)))}}Xe||(Xe={});class Je extends Me{constructor(){super(...arguments),this.transcriptions=new Ue(this._client),this.translations=new Xe(this._client),this.speech=new qe(this._client)}}!function(e){e.Transcriptions=Ue,e.Translations=Xe,e.Speech=qe}(Je||(Je={}));class He extends Me{create(e,t){return this._client.post("/moderations",(0,r.Z)({body:e},t))}}He||(He={});class Ke extends Me{retrieve(e,t){return this._client.get("/models/".concat(e),t)}list(e){return this._client.getAPIList("/models",Ve,e)}del(e,t){return this._client.delete("/models/".concat(e),t)}}class Ve extends Oe{}!function(e){e.ModelsPage=Ve}(Ke||(Ke={}));class Ye extends Me{list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return fe(t)?this.list(e,{},t):this._client.getAPIList("/fine_tuning/jobs/".concat(e,"/checkpoints"),Ge,(0,r.Z)({query:t},n))}}class Ge extends ke{}!function(e){e.FineTuningJobCheckpointsPage=Ge}(Ye||(Ye={}));class ze extends Me{constructor(){super(...arguments),this.checkpoints=new Ye(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",(0,r.Z)({body:e},t))}retrieve(e,t){return this._client.get("/fine_tuning/jobs/".concat(e),t)}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return fe(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Qe,(0,r.Z)({query:e},t))}cancel(e,t){return this._client.post("/fine_tuning/jobs/".concat(e,"/cancel"),t)}listEvents(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return fe(t)?this.listEvents(e,{},t):this._client.getAPIList("/fine_tuning/jobs/".concat(e,"/events"),$e,(0,r.Z)({query:t},n))}}class Qe extends ke{}class $e extends ke{}!function(e){e.FineTuningJobsPage=Qe,e.FineTuningJobEventsPage=$e,e.Checkpoints=Ye,e.FineTuningJobCheckpointsPage=Ge}(ze||(ze={}));class et extends Me{constructor(){super(...arguments),this.jobs=new ze(this._client)}}!function(e){e.Jobs=ze,e.FineTuningJobsPage=Qe,e.FineTuningJobEventsPage=$e}(et||(et={}));class tt extends Me{create(e,t){return this._client.post("/assistants",(0,r.Z)((0,r.Z)({body:e},t),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}retrieve(e,t){return this._client.get("/assistants/".concat(e),(0,r.Z)((0,r.Z)({},t),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}update(e,t,n){return this._client.post("/assistants/".concat(e),(0,r.Z)((0,r.Z)({body:t},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return fe(e)?this.list({},e):this._client.getAPIList("/assistants",nt,(0,r.Z)((0,r.Z)({query:e},t),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}del(e,t){return this._client.delete("/assistants/".concat(e),(0,r.Z)((0,r.Z)({},t),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}}class nt extends ke{}function st(e){return"function"===typeof e.parse}!function(e){e.AssistantsPage=nt}(tt||(tt={}));const rt=e=>"assistant"===(null===e||void 0===e?void 0:e.role),it=e=>"function"===(null===e||void 0===e?void 0:e.role),ot=e=>"tool"===(null===e||void 0===e?void 0:e.role);const at=["function_call","stream"],lt=["tool_choice","stream"];var ct,ut,ht,dt,ft,pt,mt,vt,gt,yt,wt,_t,bt,Zt,At,Et,Pt,St,xt,Rt,It=function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},Ct=function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};const Tt=10;class Ot{constructor(){ct.add(this),this.controller=new AbortController,ut.set(this,void 0),ht.set(this,(()=>{})),dt.set(this,(()=>{})),ft.set(this,void 0),pt.set(this,(()=>{})),mt.set(this,(()=>{})),vt.set(this,{}),this._chatCompletions=[],this.messages=[],gt.set(this,!1),yt.set(this,!1),wt.set(this,!1),_t.set(this,!1),St.set(this,(e=>{if(It(this,yt,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new x),e instanceof x)return It(this,wt,!0,"f"),this._emit("abort",e);if(e instanceof P)return this._emit("error",e);if(e instanceof Error){const t=new P(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new P(String(e)))})),It(this,ut,new Promise(((e,t)=>{It(this,ht,e,"f"),It(this,dt,t,"f")})),"f"),It(this,ft,new Promise(((e,t)=>{It(this,pt,e,"f"),It(this,mt,t,"f")})),"f"),Ct(this,ut,"f").catch((()=>{})),Ct(this,ft,"f").catch((()=>{}))}_run(e){setTimeout((()=>{e().then((()=>{this._emitFinal(),this._emit("end")}),Ct(this,St,"f"))}),0)}_addChatCompletion(e){var t;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=null===(t=e.choices[0])||void 0===t?void 0:t.message;return n&&this._addMessage(n),e}_addMessage(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("content"in e||(e.content=null),this.messages.push(e),t)if(this._emit("message",e),(it(e)||ot(e))&&e.content)this._emit("functionCallResult",e.content);else if(rt(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(rt(e)&&e.tool_calls)for(const n of e.tool_calls)"function"===n.type&&this._emit("functionCall",n.function)}_connected(){this.ended||(Ct(this,ht,"f").call(this),this._emit("connect"))}get ended(){return Ct(this,gt,"f")}get errored(){return Ct(this,yt,"f")}get aborted(){return Ct(this,wt,"f")}abort(){this.controller.abort()}on(e,t){return(Ct(this,vt,"f")[e]||(Ct(this,vt,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=Ct(this,vt,"f")[e];if(!n)return this;const s=n.findIndex((e=>e.listener===t));return s>=0&&n.splice(s,1),this}once(e,t){return(Ct(this,vt,"f")[e]||(Ct(this,vt,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise(((t,n)=>{It(this,_t,!0,"f"),"error"!==e&&this.once("error",n),this.once(e,t)}))}async done(){It(this,_t,!0,"f"),await Ct(this,ft,"f")}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new P("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),Ct(this,ct,"m",bt).call(this)}async finalMessage(){return await this.done(),Ct(this,ct,"m",Zt).call(this)}async finalFunctionCall(){return await this.done(),Ct(this,ct,"m",At).call(this)}async finalFunctionCallResult(){return await this.done(),Ct(this,ct,"m",Et).call(this)}async totalUsage(){return await this.done(),Ct(this,ct,"m",Pt).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];if(Ct(this,gt,"f"))return;"end"===e&&(It(this,gt,!0,"f"),Ct(this,pt,"f").call(this));const r=Ct(this,vt,"f")[e];if(r&&(Ct(this,vt,"f")[e]=r.filter((e=>!e.once)),r.forEach((e=>{let{listener:t}=e;return t(...n)}))),"abort"===e){const e=n[0];return Ct(this,_t,"f")||null!==r&&void 0!==r&&r.length||Promise.reject(e),Ct(this,dt,"f").call(this,e),Ct(this,mt,"f").call(this,e),void this._emit("end")}if("error"===e){const e=n[0];Ct(this,_t,"f")||null!==r&&void 0!==r&&r.length||Promise.reject(e),Ct(this,dt,"f").call(this,e),Ct(this,mt,"f").call(this,e),this._emit("end")}}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=Ct(this,ct,"m",Zt).call(this);t&&this._emit("finalMessage",t);const n=Ct(this,ct,"m",bt).call(this);n&&this._emit("finalContent",n);const s=Ct(this,ct,"m",At).call(this);s&&this._emit("finalFunctionCall",s);const r=Ct(this,ct,"m",Et).call(this);null!=r&&this._emit("finalFunctionCallResult",r),this._chatCompletions.some((e=>e.usage))&&this._emit("totalUsage",Ct(this,ct,"m",Pt).call(this))}async _createChatCompletion(e,t,n){const s=null===n||void 0===n?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",(()=>this.controller.abort()))),Ct(this,ct,"m",xt).call(this,t);const i=await e.create((0,r.Z)((0,r.Z)({},t),{},{stream:!1}),(0,r.Z)((0,r.Z)({},n),{},{signal:this.controller.signal}));return this._connected(),this._addChatCompletion(i)}async _runChatCompletion(e,t,n){for(const s of t.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){const s="function",{function_call:o="auto",stream:a}=t,l=(0,i.Z)(t,at),c="string"!==typeof o&&(null===o||void 0===o?void 0:o.name),{maxChatCompletions:u=Tt}=n||{},h={};for(const r of t.functions)h[r.name||r.function.name]=r;const d=t.functions.map((e=>({name:e.name||e.function.name,parameters:e.parameters,description:e.description})));for(const r of t.messages)this._addMessage(r,!1);for(let i=0;i<u;++i){var f;const t=null===(f=(await this._createChatCompletion(e,(0,r.Z)((0,r.Z)({},l),{},{function_call:o,functions:d,messages:[...this.messages]}),n)).choices[0])||void 0===f?void 0:f.message;if(!t)throw new P("missing message in ChatCompletion response");if(!t.function_call)return;const{name:i,arguments:a}=t.function_call,u=h[i];if(!u){const e="Invalid function_call: ".concat(JSON.stringify(i),". Available options are: ").concat(d.map((e=>JSON.stringify(e.name))).join(", "),". Please try again");this._addMessage({role:s,name:i,content:e});continue}if(c&&c!==i){const e="Invalid function_call: ".concat(JSON.stringify(i),". ").concat(JSON.stringify(c)," requested. Please try again");this._addMessage({role:s,name:i,content:e});continue}let m;try{m=st(u)?await u.parse(a):a}catch(p){this._addMessage({role:s,name:i,content:p instanceof Error?p.message:String(p)});continue}const v=await u.function(m,this),g=Ct(this,ct,"m",Rt).call(this,v);if(this._addMessage({role:s,name:i,content:g}),c)return}}async _runTools(e,t,n){var s;const o="tool",{tool_choice:a="auto",stream:l}=t,c=(0,i.Z)(t,lt),u="string"!==typeof a&&(null===a||void 0===a||null===(s=a.function)||void 0===s?void 0:s.name),{maxChatCompletions:h=Tt}=n||{},d={};for(const r of t.tools)"function"===r.type&&(d[r.function.name||r.function.function.name]=r.function);const f="tools"in t?t.tools.map((e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description}}:e)):void 0;for(const r of t.messages)this._addMessage(r,!1);for(let i=0;i<h;++i){var p;const t=null===(p=(await this._createChatCompletion(e,(0,r.Z)((0,r.Z)({},c),{},{tool_choice:a,tools:f,messages:[...this.messages]}),n)).choices[0])||void 0===p?void 0:p.message;if(!t)throw new P("missing message in ChatCompletion response");if(!t.tool_calls)return;for(const e of t.tool_calls){if("function"!==e.type)continue;const t=e.id,{name:n,arguments:s}=e.function,r=d[n];if(!r){const e="Invalid tool_call: ".concat(JSON.stringify(n),". Available options are: ").concat(f.map((e=>JSON.stringify(e.function.name))).join(", "),". Please try again");this._addMessage({role:o,tool_call_id:t,content:e});continue}if(u&&u!==n){const e="Invalid tool_call: ".concat(JSON.stringify(n),". ").concat(JSON.stringify(u)," requested. Please try again");this._addMessage({role:o,tool_call_id:t,content:e});continue}let i;try{i=st(r)?await r.parse(s):s}catch(m){const e=m instanceof Error?m.message:String(m);this._addMessage({role:o,tool_call_id:t,content:e});continue}const a=await r.function(i,this),l=Ct(this,ct,"m",Rt).call(this,a);if(this._addMessage({role:o,tool_call_id:t,content:l}),u)return}}}}ut=new WeakMap,ht=new WeakMap,dt=new WeakMap,ft=new WeakMap,pt=new WeakMap,mt=new WeakMap,vt=new WeakMap,gt=new WeakMap,yt=new WeakMap,wt=new WeakMap,_t=new WeakMap,St=new WeakMap,ct=new WeakSet,bt=function(){var e;return null!==(e=Ct(this,ct,"m",Zt).call(this).content)&&void 0!==e?e:null},Zt=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];var t;if(rt(n))return(0,r.Z)((0,r.Z)({},n),{},{content:null!==(t=n.content)&&void 0!==t?t:null})}throw new P("stream ended without producing a ChatCompletionMessage with role=assistant")},At=function(){for(let n=this.messages.length-1;n>=0;n--){var e;const s=this.messages[n];if(rt(s)&&null!==s&&void 0!==s&&s.function_call)return s.function_call;var t;if(rt(s)&&null!==s&&void 0!==s&&null!==(e=s.tool_calls)&&void 0!==e&&e.length)return null===(t=s.tool_calls.at(-1))||void 0===t?void 0:t.function}},Et=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(it(t)&&null!=t.content)return t.content;if(ot(t)&&null!=t.content&&this.messages.some((e=>{var n;return"assistant"===e.role&&(null===(n=e.tool_calls)||void 0===n?void 0:n.some((e=>"function"===e.type&&e.id===t.tool_call_id)))})))return t.content}},Pt=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},xt=function(e){if(null!=e.n&&e.n>1)throw new P("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Rt=function(e){return"string"===typeof e?e:void 0===e?"undefined":JSON.stringify(e)};class kt extends Ot{static runFunctions(e,t,n){const s=new kt,i=(0,r.Z)((0,r.Z)({},n),{},{headers:(0,r.Z)((0,r.Z)({},null===n||void 0===n?void 0:n.headers),{},{"X-Stainless-Helper-Method":"runFunctions"})});return s._run((()=>s._runFunctions(e,t,i))),s}static runTools(e,t,n){const s=new kt,i=(0,r.Z)((0,r.Z)({},n),{},{headers:(0,r.Z)((0,r.Z)({},null===n||void 0===n?void 0:n.headers),{},{"X-Stainless-Helper-Method":"runTools"})});return s._run((()=>s._runTools(e,t,i))),s}_addMessage(e){super._addMessage(e),rt(e)&&e.content&&this._emit("content",e.content)}}const Mt=["choices"],jt=["delta","finish_reason","index","logprobs"],Bt=["content"],Ft=["content","function_call","role","tool_calls"],Nt=["index","id","type","function"],Dt=["id","choices","created","model","system_fingerprint"],Lt=["message","finish_reason","index","logprobs"],Wt=["content","function_call","tool_calls"],qt=["function","type","id"],Ut=["arguments","name"];var Xt,Jt,Ht,Kt,Vt,Yt,Gt=function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},zt=function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n};class Qt extends Ot{constructor(){super(...arguments),Xt.add(this),Jt.set(this,void 0)}get currentChatCompletionSnapshot(){return Gt(this,Jt,"f")}static fromReadableStream(e){const t=new Qt;return t._run((()=>t._fromReadableStream(e))),t}static createChatCompletion(e,t,n){const s=new Qt;return s._run((()=>s._runChatCompletion(e,(0,r.Z)((0,r.Z)({},t),{},{stream:!0}),(0,r.Z)((0,r.Z)({},n),{},{headers:(0,r.Z)((0,r.Z)({},null===n||void 0===n?void 0:n.headers),{},{"X-Stainless-Helper-Method":"stream"})})))),s}async _createChatCompletion(e,t,n){var s;const i=null===n||void 0===n?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",(()=>this.controller.abort()))),Gt(this,Xt,"m",Ht).call(this);const a=await e.create((0,r.Z)((0,r.Z)({},t),{},{stream:!0}),(0,r.Z)((0,r.Z)({},n),{},{signal:this.controller.signal}));this._connected();var l,c=!1,u=!1;try{for(var h,d=(0,o.Z)(a);c=!(h=await d.next()).done;c=!1){const e=h.value;Gt(this,Xt,"m",Kt).call(this,e)}}catch(f){u=!0,l=f}finally{try{c&&null!=d.return&&await d.return()}finally{if(u)throw l}}if(null!==(s=a.controller.signal)&&void 0!==s&&s.aborted)throw new x;return this._addChatCompletion(Gt(this,Xt,"m",Vt).call(this))}async _fromReadableStream(e,t){var n;const s=null===t||void 0===t?void 0:t.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",(()=>this.controller.abort()))),Gt(this,Xt,"m",Ht).call(this),this._connected();const r=N.fromReadableStream(e,this.controller);let i;var a,l=!1,c=!1;try{for(var u,h=(0,o.Z)(r);l=!(u=await h.next()).done;l=!1){const e=u.value;i&&i!==e.id&&this._addChatCompletion(Gt(this,Xt,"m",Vt).call(this)),Gt(this,Xt,"m",Kt).call(this,e),i=e.id}}catch(d){c=!0,a=d}finally{try{l&&null!=h.return&&await h.return()}finally{if(c)throw a}}if(null!==(n=r.controller.signal)&&void 0!==n&&n.aborted)throw new x;return this._addChatCompletion(Gt(this,Xt,"m",Vt).call(this))}[(Jt=new WeakMap,Xt=new WeakSet,Ht=function(){this.ended||zt(this,Jt,void 0,"f")},Kt=function(e){var t,n,s;if(this.ended)return;const r=Gt(this,Xt,"m",Yt).call(this,e);this._emit("chunk",e,r);const i=null===(t=e.choices[0])||void 0===t||null===(n=t.delta)||void 0===n?void 0:n.content,o=null===(s=r.choices[0])||void 0===s?void 0:s.message;null!=i&&"assistant"===(null===o||void 0===o?void 0:o.role)&&null!==o&&void 0!==o&&o.content&&this._emit("content",i,o.content)},Vt=function(){if(this.ended)throw new P("stream has ended, this shouldn't happen");const e=Gt(this,Jt,"f");if(!e)throw new P("request ended without sending any chunks");return zt(this,Jt,void 0,"f"),function(e){const{id:t,choices:n,created:s,model:o,system_fingerprint:a}=e,l=(0,i.Z)(e,Dt);return(0,r.Z)((0,r.Z)({},l),{},{id:t,choices:n.map((t=>{let{message:n,finish_reason:s,index:o,logprobs:a}=t,l=(0,i.Z)(t,Lt);if(!s)throw new P("missing finish_reason for choice ".concat(o));const{content:c=null,function_call:u,tool_calls:h}=n,d=(0,i.Z)(n,Wt),f=n.role;if(!f)throw new P("missing role for choice ".concat(o));if(u){const{arguments:e,name:t}=u;if(null==e)throw new P("missing function_call.arguments for choice ".concat(o));if(!t)throw new P("missing function_call.name for choice ".concat(o));return(0,r.Z)((0,r.Z)({},l),{},{message:{content:c,function_call:{arguments:e,name:t},role:f},finish_reason:s,index:o,logprobs:a})}return h?(0,r.Z)((0,r.Z)({},l),{},{index:o,finish_reason:s,logprobs:a,message:(0,r.Z)((0,r.Z)({},d),{},{role:f,content:c,tool_calls:h.map(((t,n)=>{const{function:s,type:a,id:l}=t,c=(0,i.Z)(t,qt),u=s||{},{arguments:h,name:d}=u,f=(0,i.Z)(u,Ut);if(null==l)throw new P("missing choices[".concat(o,"].tool_calls[").concat(n,"].id\n").concat($t(e)));if(null==a)throw new P("missing choices[".concat(o,"].tool_calls[").concat(n,"].type\n").concat($t(e)));if(null==d)throw new P("missing choices[".concat(o,"].tool_calls[").concat(n,"].function.name\n").concat($t(e)));if(null==h)throw new P("missing choices[".concat(o,"].tool_calls[").concat(n,"].function.arguments\n").concat($t(e)));return(0,r.Z)((0,r.Z)({},c),{},{id:l,type:a,function:(0,r.Z)((0,r.Z)({},f),{},{name:d,arguments:h})})}))})}):(0,r.Z)((0,r.Z)({},l),{},{message:(0,r.Z)((0,r.Z)({},d),{},{content:c,role:f}),finish_reason:s,index:o,logprobs:a})})),created:s,model:o,object:"chat.completion"},a?{system_fingerprint:a}:{})}(e)},Yt=function(e){var t,n,s;let o=Gt(this,Jt,"f");const{choices:a}=e,l=(0,i.Z)(e,Mt);o?Object.assign(o,l):o=zt(this,Jt,(0,r.Z)((0,r.Z)({},l),{},{choices:[]}),"f");for(const f of e.choices){const{delta:e,finish_reason:a,index:l,logprobs:p=null}=f,m=(0,i.Z)(f,jt);let v=o.choices[l];if(v||(v=o.choices[l]=(0,r.Z)({finish_reason:a,index:l,message:{},logprobs:p},m)),p)if(v.logprobs){const{content:e}=p,n=(0,i.Z)(p,Bt);var c;if(Object.assign(v.logprobs,n),e)null!==(c=(t=v.logprobs).content)&&void 0!==c||(t.content=[]),v.logprobs.content.push(...e)}else v.logprobs=Object.assign({},p);if(a&&(v.finish_reason=a),Object.assign(v,m),!e)continue;const{content:g,function_call:y,role:w,tool_calls:_}=e,b=(0,i.Z)(e,Ft);var u;if(Object.assign(v.message,b),g&&(v.message.content=(v.message.content||"")+g),w&&(v.message.role=w),y)if(v.message.function_call){if(y.name&&(v.message.function_call.name=y.name),y.arguments)null!==(u=(n=v.message.function_call).arguments)&&void 0!==u||(n.arguments=""),v.message.function_call.arguments+=y.arguments}else v.message.function_call=y;if(_){v.message.tool_calls||(v.message.tool_calls=[]);for(const e of _){var h,d;const{index:t,id:n,type:r,function:o}=e,a=(0,i.Z)(e,Nt),l=null!==(h=(s=v.message.tool_calls)[t])&&void 0!==h?h:s[t]={};Object.assign(l,a),n&&(l.id=n),r&&(l.type=r),o&&(null!==(d=l.function)&&void 0!==d||(l.function={arguments:""})),null!==o&&void 0!==o&&o.name&&(l.function.name=o.name),null!==o&&void 0!==o&&o.arguments&&(l.function.arguments+=o.arguments)}}}return o},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",(n=>{const s=t.shift();s?s.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new N(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function $t(e){return JSON.stringify(e)}class en extends Qt{static fromReadableStream(e){const t=new en;return t._run((()=>t._fromReadableStream(e))),t}static runFunctions(e,t,n){const s=new en,i=(0,r.Z)((0,r.Z)({},n),{},{headers:(0,r.Z)((0,r.Z)({},null===n||void 0===n?void 0:n.headers),{},{"X-Stainless-Helper-Method":"runFunctions"})});return s._run((()=>s._runFunctions(e,t,i))),s}static runTools(e,t,n){const s=new en,i=(0,r.Z)((0,r.Z)({},n),{},{headers:(0,r.Z)((0,r.Z)({},null===n||void 0===n?void 0:n.headers),{},{"X-Stainless-Helper-Method":"runTools"})});return s._run((()=>s._runTools(e,t,i))),s}}class tn extends Me{runFunctions(e,t){return e.stream?en.runFunctions(this._client.chat.completions,e,t):kt.runFunctions(this._client.chat.completions,e,t)}runTools(e,t){return e.stream?en.runTools(this._client.chat.completions,e,t):kt.runTools(this._client.chat.completions,e,t)}stream(e,t){return Qt.createChatCompletion(this._client.chat.completions,e,t)}}class nn extends Me{constructor(){super(...arguments),this.completions=new tn(this._client)}}!function(e){e.Completions=tn}(nn||(nn={}));var sn,rn,on,an,ln,cn,un,hn,dn,fn,pn,mn,vn=function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n},gn=function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)};class yn{constructor(){this.controller=new AbortController,sn.set(this,void 0),rn.set(this,(()=>{})),on.set(this,(()=>{})),an.set(this,void 0),ln.set(this,(()=>{})),cn.set(this,(()=>{})),un.set(this,{}),hn.set(this,!1),dn.set(this,!1),fn.set(this,!1),pn.set(this,!1),mn.set(this,(e=>{if(vn(this,dn,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new x),e instanceof x)return vn(this,fn,!0,"f"),this._emit("abort",e);if(e instanceof P)return this._emit("error",e);if(e instanceof Error){const t=new P(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new P(String(e)))})),vn(this,sn,new Promise(((e,t)=>{vn(this,rn,e,"f"),vn(this,on,t,"f")})),"f"),vn(this,an,new Promise(((e,t)=>{vn(this,ln,e,"f"),vn(this,cn,t,"f")})),"f"),gn(this,sn,"f").catch((()=>{})),gn(this,an,"f").catch((()=>{}))}_run(e){setTimeout((()=>{e().then((()=>{this._emit("end")}),gn(this,mn,"f"))}),0)}_addRun(e){return e}_connected(){this.ended||(gn(this,rn,"f").call(this),this._emit("connect"))}get ended(){return gn(this,hn,"f")}get errored(){return gn(this,dn,"f")}get aborted(){return gn(this,fn,"f")}abort(){this.controller.abort()}on(e,t){return(gn(this,un,"f")[e]||(gn(this,un,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=gn(this,un,"f")[e];if(!n)return this;const s=n.findIndex((e=>e.listener===t));return s>=0&&n.splice(s,1),this}once(e,t){return(gn(this,un,"f")[e]||(gn(this,un,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise(((t,n)=>{vn(this,pn,!0,"f"),"error"!==e&&this.once("error",n),this.once(e,t)}))}async done(){vn(this,pn,!0,"f"),await gn(this,an,"f")}_emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];if(gn(this,hn,"f"))return;"end"===e&&(vn(this,hn,!0,"f"),gn(this,ln,"f").call(this));const r=gn(this,un,"f")[e];if(r&&(gn(this,un,"f")[e]=r.filter((e=>!e.once)),r.forEach((e=>{let{listener:t}=e;return t(...n)}))),"abort"===e){const e=n[0];return gn(this,pn,"f")||null!==r&&void 0!==r&&r.length||Promise.reject(e),gn(this,on,"f").call(this,e),gn(this,cn,"f").call(this,e),void this._emit("end")}if("error"===e){const e=n[0];gn(this,pn,"f")||null!==r&&void 0!==r&&r.length||Promise.reject(e),gn(this,on,"f").call(this,e),gn(this,cn,"f").call(this,e),this._emit("end")}}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,s){return await this._createAssistantStream(t,e,n,s)}async _runToolAssistantStream(e,t,n,s,r){return await this._createToolAssistantStream(n,e,t,s,r)}async _createThreadAssistantStream(e,t,n){const s=null===n||void 0===n?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",(()=>this.controller.abort())));const i=await e.createAndRun((0,r.Z)((0,r.Z)({},t),{},{stream:!1}),(0,r.Z)((0,r.Z)({},n),{},{signal:this.controller.signal}));return this._connected(),this._addRun(i)}async _createToolAssistantStream(e,t,n,s,i){const o=null===i||void 0===i?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",(()=>this.controller.abort())));const a=await e.submitToolOutputs(t,n,(0,r.Z)((0,r.Z)({},s),{},{stream:!1}),(0,r.Z)((0,r.Z)({},i),{},{signal:this.controller.signal}));return this._connected(),this._addRun(a)}async _createAssistantStream(e,t,n,s){const i=null===s||void 0===s?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",(()=>this.controller.abort())));const o=await e.create(t,(0,r.Z)((0,r.Z)({},n),{},{stream:!1}),(0,r.Z)((0,r.Z)({},s),{},{signal:this.controller.signal}));return this._connected(),this._addRun(o)}}sn=new WeakMap,rn=new WeakMap,on=new WeakMap,an=new WeakMap,ln=new WeakMap,cn=new WeakMap,un=new WeakMap,hn=new WeakMap,dn=new WeakMap,fn=new WeakMap,pn=new WeakMap,mn=new WeakMap;var wn,_n,bn,Zn,An,En,Pn,Sn,xn,Rn,In,Cn,Tn,On,kn,Mn,jn,Bn,Fn,Nn,Dn,Ln,Wn=function(e,t,n,s){if("a"===n&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?s:"a"===n?s.call(e):s?s.value:t.get(e)},qn=function(e,t,n,s,r){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?r.call(e,n):r?r.value=n:t.set(e,n),n};class Un extends yn{constructor(){super(...arguments),wn.add(this),_n.set(this,[]),bn.set(this,{}),Zn.set(this,{}),An.set(this,void 0),En.set(this,void 0),Pn.set(this,void 0),Sn.set(this,void 0),xn.set(this,void 0),Rn.set(this,void 0),In.set(this,void 0),Cn.set(this,void 0),Tn.set(this,void 0)}[(_n=new WeakMap,bn=new WeakMap,Zn=new WeakMap,An=new WeakMap,En=new WeakMap,Pn=new WeakMap,Sn=new WeakMap,xn=new WeakMap,Rn=new WeakMap,In=new WeakMap,Cn=new WeakMap,Tn=new WeakMap,wn=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",(n=>{const s=t.shift();s?s.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new Un;return t._run((()=>t._fromReadableStream(e))),t}async _fromReadableStream(e,t){var n;const s=null===t||void 0===t?void 0:t.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",(()=>this.controller.abort()))),this._connected();const r=N.fromReadableStream(e,this.controller);var i,a=!1,l=!1;try{for(var c,u=(0,o.Z)(r);a=!(c=await u.next()).done;a=!1){const e=c.value;Wn(this,wn,"m",On).call(this,e)}}catch(h){l=!0,i=h}finally{try{a&&null!=u.return&&await u.return()}finally{if(l)throw i}}if(null!==(n=r.controller.signal)&&void 0!==n&&n.aborted)throw new x;return this._addRun(Wn(this,wn,"m",kn).call(this))}toReadableStream(){return new N(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,s,i){const o=new Un;return o._run((()=>o._runToolAssistantStream(e,t,n,s,(0,r.Z)((0,r.Z)({},i),{},{headers:(0,r.Z)((0,r.Z)({},null===i||void 0===i?void 0:i.headers),{},{"X-Stainless-Helper-Method":"stream"})})))),o}async _createToolAssistantStream(e,t,n,s,i){var a;const l=null===i||void 0===i?void 0:i.signal;l&&(l.aborted&&this.controller.abort(),l.addEventListener("abort",(()=>this.controller.abort())));const c=(0,r.Z)((0,r.Z)({},s),{},{stream:!0}),u=await e.submitToolOutputs(t,n,c,(0,r.Z)((0,r.Z)({},i),{},{signal:this.controller.signal}));this._connected();var h,d=!1,f=!1;try{for(var p,m=(0,o.Z)(u);d=!(p=await m.next()).done;d=!1){const e=p.value;Wn(this,wn,"m",On).call(this,e)}}catch(v){f=!0,h=v}finally{try{d&&null!=m.return&&await m.return()}finally{if(f)throw h}}if(null!==(a=u.controller.signal)&&void 0!==a&&a.aborted)throw new x;return this._addRun(Wn(this,wn,"m",kn).call(this))}static createThreadAssistantStream(e,t,n){const s=new Un;return s._run((()=>s._threadAssistantStream(e,t,(0,r.Z)((0,r.Z)({},n),{},{headers:(0,r.Z)((0,r.Z)({},null===n||void 0===n?void 0:n.headers),{},{"X-Stainless-Helper-Method":"stream"})})))),s}static createAssistantStream(e,t,n,s){const i=new Un;return i._run((()=>i._runAssistantStream(e,t,n,(0,r.Z)((0,r.Z)({},s),{},{headers:(0,r.Z)((0,r.Z)({},null===s||void 0===s?void 0:s.headers),{},{"X-Stainless-Helper-Method":"stream"})})))),i}currentEvent(){return Wn(this,In,"f")}currentRun(){return Wn(this,Cn,"f")}currentMessageSnapshot(){return Wn(this,An,"f")}currentRunStepSnapshot(){return Wn(this,Tn,"f")}async finalRunSteps(){return await this.done(),Object.values(Wn(this,bn,"f"))}async finalMessages(){return await this.done(),Object.values(Wn(this,Zn,"f"))}async finalRun(){if(await this.done(),!Wn(this,En,"f"))throw Error("Final run was not received.");return Wn(this,En,"f")}async _createThreadAssistantStream(e,t,n){var s;const i=null===n||void 0===n?void 0:n.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",(()=>this.controller.abort())));const a=(0,r.Z)((0,r.Z)({},t),{},{stream:!0}),l=await e.createAndRun(a,(0,r.Z)((0,r.Z)({},n),{},{signal:this.controller.signal}));this._connected();var c,u=!1,h=!1;try{for(var d,f=(0,o.Z)(l);u=!(d=await f.next()).done;u=!1){const e=d.value;Wn(this,wn,"m",On).call(this,e)}}catch(p){h=!0,c=p}finally{try{u&&null!=f.return&&await f.return()}finally{if(h)throw c}}if(null!==(s=l.controller.signal)&&void 0!==s&&s.aborted)throw new x;return this._addRun(Wn(this,wn,"m",kn).call(this))}async _createAssistantStream(e,t,n,s){var i;const a=null===s||void 0===s?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",(()=>this.controller.abort())));const l=(0,r.Z)((0,r.Z)({},n),{},{stream:!0}),c=await e.create(t,l,(0,r.Z)((0,r.Z)({},s),{},{signal:this.controller.signal}));this._connected();var u,h=!1,d=!1;try{for(var f,p=(0,o.Z)(c);h=!(f=await p.next()).done;h=!1){const e=f.value;Wn(this,wn,"m",On).call(this,e)}}catch(m){d=!0,u=m}finally{try{h&&null!=p.return&&await p.return()}finally{if(d)throw u}}if(null!==(i=c.controller.signal)&&void 0!==i&&i.aborted)throw new x;return this._addRun(Wn(this,wn,"m",kn).call(this))}static accumulateDelta(e,t){for(const[n,s]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=s;continue}let t=e[n];if(null!==t&&void 0!==t)if("index"!==n&&"type"!==n){if("string"===typeof t&&"string"===typeof s)t+=s;else if("number"===typeof t&&"number"===typeof s)t+=s;else if(Te(t)&&Te(s))t=this.accumulateDelta(t,s);else{if(!Array.isArray(t)||!Array.isArray(s))throw Error("Unhandled record type: ".concat(n,", deltaValue: ").concat(s,", accValue: ").concat(t));if(t.every((e=>"string"===typeof e||"number"===typeof e))){t.push(...s);continue}}e[n]=t}else e[n]=s;else e[n]=s}return e}}On=function(e){if(!this.ended)switch(qn(this,In,e,"f"),Wn(this,wn,"m",Bn).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Wn(this,wn,"m",Ln).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Wn(this,wn,"m",jn).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Wn(this,wn,"m",Mn).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},kn=function(){if(this.ended)throw new P("stream has ended, this shouldn't happen");if(!Wn(this,En,"f"))throw Error("Final run has not been received");return Wn(this,En,"f")},Mn=function(e){const[t,n]=Wn(this,wn,"m",Nn).call(this,e,Wn(this,An,"f"));qn(this,An,t,"f"),Wn(this,Zn,"f")[t.id]=t;for(const s of n){const e=t.content[s.index];"text"==(null===e||void 0===e?void 0:e.type)&&this._emit("textCreated",e.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const n of e.data.delta.content){if("text"==n.type&&n.text){let e=n.text,s=t.content[n.index];if(!s||"text"!=s.type)throw Error("The snapshot associated with this text delta is not text or missing");this._emit("textDelta",e,s.text)}if(n.index!=Wn(this,Pn,"f")){if(Wn(this,Sn,"f"))switch(Wn(this,Sn,"f").type){case"text":this._emit("textDone",Wn(this,Sn,"f").text,Wn(this,An,"f"));break;case"image_file":this._emit("imageFileDone",Wn(this,Sn,"f").image_file,Wn(this,An,"f"))}qn(this,Pn,n.index,"f")}qn(this,Sn,t.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==Wn(this,Pn,"f")){const t=e.data.content[Wn(this,Pn,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,Wn(this,An,"f"));break;case"text":this._emit("textDone",t.text,Wn(this,An,"f"))}}Wn(this,An,"f")&&this._emit("messageDone",e.data),qn(this,An,void 0,"f")}},jn=function(e){const t=Wn(this,wn,"m",Fn).call(this,e);switch(qn(this,Tn,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&"tool_calls"==n.step_details.type&&n.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(const e of n.step_details.tool_calls)e.index==Wn(this,xn,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(Wn(this,Rn,"f")&&this._emit("toolCallDone",Wn(this,Rn,"f")),qn(this,xn,e.index,"f"),qn(this,Rn,t.step_details.tool_calls[e.index],"f"),Wn(this,Rn,"f")&&this._emit("toolCallCreated",Wn(this,Rn,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":qn(this,Tn,void 0,"f");"tool_calls"==e.data.step_details.type&&Wn(this,Rn,"f")&&(this._emit("toolCallDone",Wn(this,Rn,"f")),qn(this,Rn,void 0,"f")),this._emit("runStepDone",e.data,t)}},Bn=function(e){Wn(this,_n,"f").push(e),this._emit("event",e)},Fn=function(e){switch(e.event){case"thread.run.step.created":return Wn(this,bn,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=Wn(this,bn,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const s=Un.accumulateDelta(t,n.delta);Wn(this,bn,"f")[e.data.id]=s}return Wn(this,bn,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Wn(this,bn,"f")[e.data.id]=e.data}if(Wn(this,bn,"f")[e.data.id])return Wn(this,bn,"f")[e.data.id];throw new Error("No snapshot available")},Nn=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const e of s.delta.content)if(e.index in t.content){let n=t.content[e.index];t.content[e.index]=Wn(this,wn,"m",Dn).call(this,e,n)}else t.content[e.index]=e,n.push(e);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Dn=function(e,t){return Un.accumulateDelta(t,e)},Ln=function(e){switch(qn(this,Cn,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.cancelling":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":qn(this,En,e.data,"f"),Wn(this,Rn,"f")&&(this._emit("toolCallDone",Wn(this,Rn,"f")),qn(this,Rn,void 0,"f"))}};class Xn extends Me{create(e,t,n){return this._client.post("/threads/".concat(e,"/messages"),(0,r.Z)((0,r.Z)({body:t},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}retrieve(e,t,n){return this._client.get("/threads/".concat(e,"/messages/").concat(t),(0,r.Z)((0,r.Z)({},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}update(e,t,n,s){return this._client.post("/threads/".concat(e,"/messages/").concat(t),(0,r.Z)((0,r.Z)({body:n},s),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===s||void 0===s?void 0:s.headers)}))}list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return fe(t)?this.list(e,{},t):this._client.getAPIList("/threads/".concat(e,"/messages"),Jn,(0,r.Z)((0,r.Z)({query:t},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}del(e,t,n){return this._client.delete("/threads/".concat(e,"/messages/").concat(t),(0,r.Z)((0,r.Z)({},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}}class Jn extends ke{}!function(e){e.MessagesPage=Jn}(Xn||(Xn={}));class Hn extends Me{retrieve(e,t,n,s){return this._client.get("/threads/".concat(e,"/runs/").concat(t,"/steps/").concat(n),(0,r.Z)((0,r.Z)({},s),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===s||void 0===s?void 0:s.headers)}))}list(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;return fe(n)?this.list(e,t,{},n):this._client.getAPIList("/threads/".concat(e,"/runs/").concat(t,"/steps"),Kn,(0,r.Z)((0,r.Z)({query:n},s),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===s||void 0===s?void 0:s.headers)}))}}class Kn extends ke{}!function(e){e.RunStepsPage=Kn}(Hn||(Hn={}));class Vn extends Me{constructor(){super(...arguments),this.steps=new Hn(this._client)}create(e,t,n){var s;return this._client.post("/threads/".concat(e,"/runs"),(0,r.Z)((0,r.Z)({body:t},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers),stream:null!==(s=t.stream)&&void 0!==s&&s}))}retrieve(e,t,n){return this._client.get("/threads/".concat(e,"/runs/").concat(t),(0,r.Z)((0,r.Z)({},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}update(e,t,n,s){return this._client.post("/threads/".concat(e,"/runs/").concat(t),(0,r.Z)((0,r.Z)({body:n},s),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===s||void 0===s?void 0:s.headers)}))}list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return fe(t)?this.list(e,{},t):this._client.getAPIList("/threads/".concat(e,"/runs"),Yn,(0,r.Z)((0,r.Z)({query:t},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}cancel(e,t,n){return this._client.post("/threads/".concat(e,"/runs/").concat(t,"/cancel"),(0,r.Z)((0,r.Z)({},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}async createAndPoll(e,t,n){const s=await this.create(e,t,n);return await this.poll(e,s.id,n)}createAndStream(e,t,n){return Un.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){const s=(0,r.Z)((0,r.Z)({},null===n||void 0===n?void 0:n.headers),{},{"X-Stainless-Poll-Helper":"true"});for(null!==n&&void 0!==n&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,t,(0,r.Z)((0,r.Z)({},n),{},{headers:(0,r.Z)((0,r.Z)({},null===n||void 0===n?void 0:n.headers),s)})).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let e=5e3;if(null!==n&&void 0!==n&&n.pollIntervalMs)e=n.pollIntervalMs;else{const t=o.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await Ze(e);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,t,n){return Un.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,s){var i;return this._client.post("/threads/".concat(e,"/runs/").concat(t,"/submit_tool_outputs"),(0,r.Z)((0,r.Z)({body:n},s),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===s||void 0===s?void 0:s.headers),stream:null!==(i=n.stream)&&void 0!==i&&i}))}async submitToolOutputsAndPoll(e,t,n,s){const r=await this.submitToolOutputs(e,t,n,s);return await this.poll(e,r.id,s)}submitToolOutputsStream(e,t,n,s){return Un.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,s)}}class Yn extends ke{}!function(e){e.RunsPage=Yn,e.Steps=Hn,e.RunStepsPage=Kn}(Vn||(Vn={}));class Gn extends Me{constructor(){super(...arguments),this.runs=new Vn(this._client),this.messages=new Xn(this._client)}create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return fe(e)?this.create({},e):this._client.post("/threads",(0,r.Z)((0,r.Z)({body:e},t),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}retrieve(e,t){return this._client.get("/threads/".concat(e),(0,r.Z)((0,r.Z)({},t),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}update(e,t,n){return this._client.post("/threads/".concat(e),(0,r.Z)((0,r.Z)({body:t},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}del(e,t){return this._client.delete("/threads/".concat(e),(0,r.Z)((0,r.Z)({},t),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}createAndRun(e,t){var n;return this._client.post("/threads/runs",(0,r.Z)((0,r.Z)({body:e},t),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers),stream:null!==(n=e.stream)&&void 0!==n&&n}))}async createAndRunPoll(e,t){const n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return Un.createThreadAssistantStream(e,this._client.beta.threads,t)}}!function(e){e.Runs=Vn,e.RunsPage=Yn,e.Messages=Xn,e.MessagesPage=Jn}(Gn||(Gn={}));class zn extends Me{create(e,t,n){return this._client.post("/vector_stores/".concat(e,"/files"),(0,r.Z)((0,r.Z)({body:t},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}retrieve(e,t,n){return this._client.get("/vector_stores/".concat(e,"/files/").concat(t),(0,r.Z)((0,r.Z)({},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return fe(t)?this.list(e,{},t):this._client.getAPIList("/vector_stores/".concat(e,"/files"),Qn,(0,r.Z)((0,r.Z)({query:t},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}del(e,t,n){return this._client.delete("/vector_stores/".concat(e,"/files/").concat(t),(0,r.Z)((0,r.Z)({},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}async createAndPoll(e,t,n){const s=await this.create(e,t,n);return await this.poll(e,s.id,n)}async poll(e,t,n){const s=(0,r.Z)((0,r.Z)({},null===n||void 0===n?void 0:n.headers),{},{"X-Stainless-Poll-Helper":"true"});for(null!==n&&void 0!==n&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const i=await this.retrieve(e,t,(0,r.Z)((0,r.Z)({},n),{},{headers:s})).withResponse(),o=i.data;switch(o.status){case"in_progress":let e=5e3;if(null!==n&&void 0!==n&&n.pollIntervalMs)e=n.pollIntervalMs;else{const t=i.response.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await Ze(e);break;case"failed":case"completed":return o}}}async upload(e,t,n){const s=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:s.id},n)}async uploadAndPoll(e,t,n){const s=await this.upload(e,t,n);return await this.poll(e,s.id,n)}}class Qn extends ke{}!function(e){e.VectorStoreFilesPage=Qn}(zn||(zn={}));class $n extends Me{create(e,t,n){return this._client.post("/vector_stores/".concat(e,"/file_batches"),(0,r.Z)((0,r.Z)({body:t},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}retrieve(e,t,n){return this._client.get("/vector_stores/".concat(e,"/file_batches/").concat(t),(0,r.Z)((0,r.Z)({},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}cancel(e,t,n){return this._client.post("/vector_stores/".concat(e,"/file_batches/").concat(t,"/cancel"),(0,r.Z)((0,r.Z)({},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}async createAndPoll(e,t,n){const s=await this.create(e,t);return await this.poll(e,s.id,n)}listFiles(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;return fe(n)?this.listFiles(e,t,{},n):this._client.getAPIList("/vector_stores/".concat(e,"/file_batches/").concat(t,"/files"),Qn,(0,r.Z)((0,r.Z)({query:n},s),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===s||void 0===s?void 0:s.headers)}))}async poll(e,t,n){const s=(0,r.Z)((0,r.Z)({},null===n||void 0===n?void 0:n.headers),{},{"X-Stainless-Poll-Helper":"true"});for(null!==n&&void 0!==n&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,t,(0,r.Z)((0,r.Z)({},n),{},{headers:s})).withResponse();switch(i.status){case"in_progress":let e=5e3;if(null!==n&&void 0!==n&&n.pollIntervalMs)e=n.pollIntervalMs;else{const t=o.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await Ze(e);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,t,n){var s;let{files:r,fileIds:i=[]}=t;if(null===r||0==r.length)throw new Error("No files provided to process.");const o=null!==(s=null===n||void 0===n?void 0:n.maxConcurrency)&&void 0!==s?s:5,a=Math.min(o,r.length),l=this._client,c=r.values(),u=[...i];const h=Array(a).fill(c).map((async function(e){for(let t of e){const e=await l.files.create({file:t,purpose:"assistants"},n);u.push(e.id)}}));return await(async e=>{const t=await Promise.allSettled(e),n=t.filter((e=>"rejected"===e.status));if(n.length){for(const e of n)console.error(e.reason);throw new Error("".concat(n.length," promise(s) failed - see the above errors"))}const s=[];for(const r of t)"fulfilled"===r.status&&s.push(r.value);return s})(h),await this.createAndPoll(e,{file_ids:u})}}$n||($n={});class es extends Me{constructor(){super(...arguments),this.files=new zn(this._client),this.fileBatches=new $n(this._client)}create(e,t){return this._client.post("/vector_stores",(0,r.Z)((0,r.Z)({body:e},t),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}retrieve(e,t){return this._client.get("/vector_stores/".concat(e),(0,r.Z)((0,r.Z)({},t),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}update(e,t,n){return this._client.post("/vector_stores/".concat(e),(0,r.Z)((0,r.Z)({body:t},n),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return fe(e)?this.list({},e):this._client.getAPIList("/vector_stores",ts,(0,r.Z)((0,r.Z)({query:e},t),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}del(e,t){return this._client.delete("/vector_stores/".concat(e),(0,r.Z)((0,r.Z)({},t),{},{headers:(0,r.Z)({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}}class ts extends ke{}!function(e){e.VectorStoresPage=ts,e.Files=zn,e.VectorStoreFilesPage=Qn,e.FileBatches=$n}(es||(es={}));class ns extends Me{constructor(){super(...arguments),this.vectorStores=new es(this._client),this.chat=new nn(this._client),this.assistants=new tt(this._client),this.threads=new Gn(this._client)}}!function(e){e.VectorStores=es,e.VectorStoresPage=ts,e.Chat=nn,e.Assistants=tt,e.AssistantsPage=nt,e.Threads=Gn}(ns||(ns={}));class ss extends Me{create(e,t){return this._client.post("/batches",(0,r.Z)({body:e},t))}retrieve(e,t){return this._client.get("/batches/".concat(e),t)}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return fe(e)?this.list({},e):this._client.getAPIList("/batches",rs,(0,r.Z)({query:e},t))}cancel(e,t){return this._client.post("/batches/".concat(e,"/cancel"),t)}}class rs extends ke{}!function(e){e.BatchesPage=rs}(ss||(ss={}));const is=["baseURL","apiKey","organization","project"];var os;class as extends le{constructor(){var e,t,n;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{baseURL:o=Pe("OPENAI_BASE_URL"),apiKey:a=Pe("OPENAI_API_KEY"),organization:l=(null!==(e=Pe("OPENAI_ORG_ID"))&&void 0!==e?e:null),project:c=(null!==(t=Pe("OPENAI_PROJECT_ID"))&&void 0!==t?t:null)}=s,u=(0,i.Z)(s,is);if(void 0===a)throw new P("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const h=(0,r.Z)((0,r.Z)({apiKey:a,organization:l,project:c},u),{},{baseURL:o||"https://api.openai.com/v1"});if(!h.dangerouslyAllowBrowser&&"undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof navigator)throw new P("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:h.baseURL,timeout:null!==(n=h.timeout)&&void 0!==n?n:6e5,httpAgent:h.httpAgent,maxRetries:h.maxRetries,fetch:h.fetch}),this.completions=new je(this),this.chat=new Fe(this),this.embeddings=new Ne(this),this.files=new De(this),this.images=new We(this),this.audio=new Je(this),this.moderations=new He(this),this.models=new Ke(this),this.fineTuning=new et(this),this.beta=new ns(this),this.batches=new ss(this),this._options=h,this.apiKey=a,this.organization=l,this.project=c}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return(0,r.Z)((0,r.Z)({},super.defaultHeaders(e)),{},{"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},this._options.defaultHeaders)}authHeaders(e){return{Authorization:"Bearer ".concat(this.apiKey)}}}os=as,as.OpenAI=os,as.OpenAIError=P,as.APIError=S,as.APIConnectionError=R,as.APIConnectionTimeoutError=I,as.APIUserAbortError=x,as.NotFoundError=k,as.ConflictError=M,as.RateLimitError=B,as.BadRequestError=C,as.AuthenticationError=T,as.InternalServerError=F,as.PermissionDeniedError=O,as.UnprocessableEntityError=j,as.toFile=Y,as.fileFromPath=g;const{OpenAIError:ls,APIError:cs,APIConnectionError:us,APIConnectionTimeoutError:hs,APIUserAbortError:ds,NotFoundError:fs,ConflictError:ps,RateLimitError:ms,BadRequestError:vs,AuthenticationError:gs,InternalServerError:ys,PermissionDeniedError:ws,UnprocessableEntityError:_s}=s;!function(e){e.Page=Oe,e.CursorPage=ke,e.Completions=je,e.Chat=Fe,e.Embeddings=Ne,e.Files=De,e.FileObjectsPage=Le,e.Images=We,e.Audio=Je,e.Moderations=He,e.Models=Ke,e.ModelsPage=Ve,e.FineTuning=et,e.Beta=ns,e.Batches=ss,e.BatchesPage=rs}(as||(as={}));new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations","/batches"]);const bs=as},876:(e,t,n)=>{function s(e,t){this.v=e,this.k=t}n.d(t,{Z:()=>s})},74269:(e,t,n)=>{function s(e){var t,n,s,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,s=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(s&&null!=(t=e[s]))return new r(t.call(e));n="@@asyncIterator",s="@@iterator"}throw new TypeError("Object is not async iterable")}function r(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return r=function(e){this.s=e,this.n=e.next},r.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new r(e)}n.d(t,{Z:()=>s})},60715:(e,t,n)=>{n.d(t,{Z:()=>r});var s=n(876);function r(e){return new s.Z(e,0)}},3206:(e,t,n)=>{n.d(t,{Z:()=>i});var s=n(876);function r(e){var t,n;function r(t,n){try{var o=e[t](n),a=o.value,l=a instanceof s.Z;Promise.resolve(l?a.v:a).then((function(n){if(l){var s="return"===t?"return":"next";if(!a.k||n.done)return r(s,n);n=e[s](n).value}i(o.done?"return":"normal",n)}),(function(e){r("throw",e)}))}catch(c){i("throw",c)}}function i(e,s){switch(e){case"return":t.resolve({value:s,done:!0});break;case"throw":t.reject(s);break;default:t.resolve({value:s,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,s){return new Promise((function(i,o){var a={key:e,arg:s,resolve:i,reject:o,next:null};n?n=n.next=a:(t=n=a,r(e,s))}))},"function"!=typeof e.return&&(this.return=void 0)}function i(e){return function(){return new r(e.apply(this,arguments))}}r.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},r.prototype.next=function(e){return this._invoke("next",e)},r.prototype.throw=function(e){return this._invoke("throw",e)},r.prototype.return=function(e){return this._invoke("return",e)}}}]);
//# sourceMappingURL=34260.73633aaf.chunk.js.map
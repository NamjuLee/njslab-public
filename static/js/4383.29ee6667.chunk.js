"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[4383],{4383:(e,t,o)=>{o.r(t),o.d(t,{default:()=>W});var n=o(78808),r=(o(75254),o(43929)),i=(o(81735),o(12207),o(31108),o(42765),o(62502),o(55417),o(57586),o(83596),o(58620),o(15399)),s=o(5674),a=o(90754),l=(o(83194),o(75476),o(90825)),p=o(57598),u=o(63573),c=o(64299),d=o(1871),y=o(94452),f=o(13572),g=o(90967),m=o(74174);let h=class extends d.Z{constructor(){super(...arguments),this.featureDefinition=null,this.type="ogc-feature"}load(e){return this.addResolvingPromise(this._loadOGCServices(this.layer,e)),this.when()}getSource(){const{featureDefinition:{collection:e,layerDefinition:t,spatialReference:o,supportedCrs:n},layer:{apiKey:r,customParameters:i,effectiveMaxRecordCount:s}}=this;return{type:"ogc-source",collection:e,layerDefinition:t,maxRecordCount:s,queryParameters:{apiKey:r,customParameters:i},spatialReference:o,supportedCrs:n}}queryExtent(e){return null}queryFeatureCount(e){return null}queryFeatures(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.queryFeaturesJSON(e,t).then((e=>g.default.fromJSON(e)))}queryFeaturesJSON(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=this.getSource();return this.load(t).then((()=>(0,f.yN)(o,e,t)))}queryObjectIds(e){return null}serviceSupportsSpatialReference(e){return!(!e.isWGS84&&!e.isWebMercator)||!!this.featureDefinition.supportedCrs[e.wkid]}_conformsToType(e,t){var o;const n=new RegExp("^".concat(t,"$"),"i");return null!==(o=e.conformsTo.some((e=>n.test(e))))&&void 0!==o&&o}_getCapabilities(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},query:{maxRecordCount:t,maxRecordCountFactor:void 0,standardMaxRecordCount:void 0,supportsCacheHint:!1,supportsCentroid:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsStatistics:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,supportsSqlExpression:!1,tileMaxRecordCount:void 0},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUploadWithItemId:!1,supportsUpdateWithoutM:!1}}}_getMaxRecordCount(e){var t,o,n,r,i,s,a,l,p;return null!==(t=null===e||void 0===e||null===(o=e.components)||void 0===o||null===(n=o.parameters)||void 0===n||null===(r=n.limit)||void 0===r||null===(i=r.schema)||void 0===i?void 0:i.maximum)&&void 0!==t?t:null===e||void 0===e||null===(s=e.components)||void 0===s||null===(a=s.parameters)||void 0===a||null===(l=a.limitFeatures)||void 0===l||null===(p=l.schema)||void 0===p?void 0:p.maximum}_getStorageSpatialReference(e){var t;const o=null!==(t=e.storageCrs)&&void 0!==t?t:f.$9,n=(0,f.d)(o);return(0,y.Wi)(n)?m.Z.WGS84:new m.Z({wkid:n})}_getSupportedSpatialReferences(e,t){var o;const n="#/crs",r=null!==(o=e.crs)&&void 0!==o?o:[f.$9],i=r.includes(n)?r.filter((e=>e!==n)).concat(t.crs):r,s=/^http:\/\/www\.opengis.net\/def\/crs\/epsg\/.*\/3785$/i;return i.filter((e=>!s.test(e)))}async _loadOGCServices(e,t){const o=(0,y.pC)(t)?t.signal:null,{apiKey:n,collectionId:r,customParameters:i,fields:s,geometryType:a,hasZ:l,objectIdField:u,timeInfo:d,url:g}=e,m={fields:null===s||void 0===s?void 0:s.map((e=>e.toJSON())),geometryType:p.P$.toJSON(a),hasZ:l,objectIdField:u,timeInfo:null===d||void 0===d?void 0:d.toJSON()},h={apiKey:n,customParameters:i,signal:o},v=await(0,f.gp)(g,h),[b,w]=await Promise.all([(0,f.G4)(v,h),(0,f.j)(v,h)]);if(!this._conformsToType(b,"http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/geojson"))throw new c.Z("ogc-feature-layer:no-geojson-support","Server does not support geojson");const S=w.collections.find((e=>e.id===r));if(!S)throw new c.Z("ogc-feature-layer:collection-not-found","Server does not contain the named collection");const C=this._conformsToType(b,"http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/oas30")?await(0,f.eS)(v,h):null,F=await(0,f.w9)(S,m,h),I=this._getMaxRecordCount(C),x=this._getCapabilities(F.hasZ,I),T=this._getStorageSpatialReference(S).toJSON(),j=this._getSupportedSpatialReferences(S,w),Z=new RegExp("^".concat(f.Lu),"i"),R={};for(const p of j){const e=(0,f.d)(p);(0,y.pC)(e)&&(R[e]||(R[e]=p.replace(Z,"")))}this.featureDefinition={capabilities:x,collection:S,layerDefinition:F,spatialReference:T,supportedCrs:R}}};(0,n._)([(0,a.Cb)()],h.prototype,"featureDefinition",void 0),(0,n._)([(0,a.Cb)({constructOnly:!0})],h.prototype,"layer",void 0),(0,n._)([(0,a.Cb)()],h.prototype,"type",void 0),h=(0,n._)([(0,l.j)("esri.layers.graphics.sources.OGCFeatureSource")],h);var v=o(79017),b=o(62515),w=o(74099),S=o(41578),C=o(68795),F=o(33298),I=o(82669),x=o(50138),T=o(96980),j=o(91466),Z=o(90218),R=o(53815),_=o(63014),O=o(46858),P=o(28851),k=o(11004),D=o(97605),G=o(81657),M=o(35973),q=o(67709),N=o(37299);const E=(0,P.v)();let A=class extends((0,v.V)((0,w.N)((0,C.M)((0,S.b)((0,b.h)((0,I.c)((0,Z.n)((0,j.M)((0,F.q)((0,x.I)((0,T.Q)((0,s.R)(u.Z))))))))))))){constructor(e){super(e),this.collectionId=null,this.copyright=null,this.definitionExpression=null,this.description=null,this.displayField=null,this.elevationInfo=null,this.fields=null,this.fieldsIndex=null,this.fullExtent=null,this.geometryType=null,this.hasZ=void 0,this.labelingInfo=null,this.labelsVisible=!0,this.legendEnabled=!0,this.maxRecordCount=null,this.objectIdField=null,this.operationalLayerType="OGCFeatureLayer",this.popupEnabled=!0,this.popupTemplate=null,this.screenSizePerspectiveEnabled=!0,this.source=new h({layer:this}),this.spatialReference=null,this.title=null,this.type="ogc-feature",this.typeIdField=null,this.types=null,this.url=null}destroy(){var e;null===(e=this.source)||void 0===e||e.destroy()}load(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["OGCFeatureServer"]},e).then((()=>this._fetchService(e)))),this.when()}get defaultPopupTemplate(){return this.createPopupTemplate()}get effectiveMaxRecordCount(){var e,t,o;return null!==(e=null!==(t=this.maxRecordCount)&&void 0!==t?t:null===(o=this.capabilities)||void 0===o?void 0:o.query.maxRecordCount)&&void 0!==e?e:5e3}get isTable(){return this.loaded&&null==this.geometryType}set renderer(e){(0,k.YN)(e,this.fieldsIndex),this._set("renderer",e)}on(e,t){return super.on(e,t)}createPopupTemplate(e){return(0,q.eZ)(this,e)}createQuery(){return new M.Z}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,t){var o;let n,r=!1;const i=null===t||void 0===t||null===(o=t.feature)||void 0===o?void 0:o.attributes,s=this.typeIdField&&(null===i||void 0===i?void 0:i[this.typeIdField]);return null!=s&&this.types&&(r=this.types.some((t=>{var o,r;return t.id==s&&(n=null===(o=t.domains)||void 0===o?void 0:o[e],"inherited"===(null===(r=n)||void 0===r?void 0:r.type)&&(n=this._getLayerDomain(e)),!0)}))),r||n||(n=this._getLayerDomain(e)),n}queryFeatures(e,t){return this.load().then((()=>this.source.queryFeatures(M.Z.from(e)||this.createQuery(),t))).then((e=>{var t;return null!==e&&void 0!==e&&null!==(t=e.features)&&void 0!==t&&t.forEach((e=>{e.layer=e.sourceLayer=this})),e}))}serviceSupportsSpatialReference(e){var t,o;return null!==(t=null===(o=this.source)||void 0===o?void 0:o.serviceSupportsSpatialReference(e))&&void 0!==t&&t}async _fetchService(e){await this.source.load(e),this.read(this.source.featureDefinition,{origin:"service"}),(0,k.YN)(this.renderer,this.fieldsIndex),(0,k.UF)(this.timeInfo,this.fieldsIndex)}_getLayerDomain(e){if(!this.fields)return null;for(const t of this.fields)if(t.name===e&&t.domain)return t.domain;return null}};(0,n._)([(0,a.Cb)({readOnly:!0,json:{origins:{service:{read:!0}}}})],A.prototype,"capabilities",void 0),(0,n._)([(0,a.Cb)({type:String,json:{write:!0}})],A.prototype,"collectionId",void 0),(0,n._)([(0,a.Cb)({type:String})],A.prototype,"copyright",void 0),(0,n._)([(0,a.Cb)({readOnly:!0})],A.prototype,"defaultPopupTemplate",null),(0,n._)([(0,a.Cb)({type:String})],A.prototype,"definitionExpression",void 0),(0,n._)([(0,a.Cb)({readOnly:!0,type:String,json:{origins:{service:{name:"collection.description"}}}})],A.prototype,"description",void 0),(0,n._)([(0,a.Cb)({type:String})],A.prototype,"displayField",void 0),(0,n._)([(0,a.Cb)({type:Number})],A.prototype,"effectiveMaxRecordCount",null),(0,n._)([(0,a.Cb)(R.PV)],A.prototype,"elevationInfo",void 0),(0,n._)([(0,a.Cb)({type:[O.Z],json:{origins:{service:{name:"layerDefinition.fields"}}}})],A.prototype,"fields",void 0),(0,n._)([(0,a.Cb)(E.fieldsIndex)],A.prototype,"fieldsIndex",void 0),(0,n._)([(0,a.Cb)({readOnly:!0,type:N.Z,json:{origins:{service:{name:"layerDefinition.extent"}}}})],A.prototype,"fullExtent",void 0),(0,n._)([(0,a.Cb)({type:p.Mk.apiValues,json:{origins:{service:{name:"layerDefinition.geometryType",read:{reader:p.Mk.read}}}}})],A.prototype,"geometryType",void 0),(0,n._)([(0,a.Cb)({type:Boolean,json:{origins:{service:{name:"layerDefinition.hasZ"}}}})],A.prototype,"hasZ",void 0),(0,n._)([(0,a.Cb)({type:Boolean,readOnly:!0})],A.prototype,"isTable",null),(0,n._)([(0,a.Cb)({type:[D.Z],json:{origins:{"web-document":{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:G.r},write:!0}}}})],A.prototype,"labelingInfo",void 0),(0,n._)([(0,a.Cb)(R.iR)],A.prototype,"labelsVisible",void 0),(0,n._)([(0,a.Cb)(R.rn)],A.prototype,"legendEnabled",void 0),(0,n._)([(0,a.Cb)({type:Number})],A.prototype,"maxRecordCount",void 0),(0,n._)([(0,a.Cb)({type:String,json:{origins:{service:{name:"layerDefinition.objectIdField"}}}})],A.prototype,"objectIdField",void 0),(0,n._)([(0,a.Cb)({type:["OGCFeatureLayer"]})],A.prototype,"operationalLayerType",void 0),(0,n._)([(0,a.Cb)(R.C_)],A.prototype,"popupEnabled",void 0),(0,n._)([(0,a.Cb)({type:r.Z,json:{name:"popupInfo",write:!0}})],A.prototype,"popupTemplate",void 0),(0,n._)([(0,a.Cb)({types:i.A,json:{origins:{service:{name:"layerDefinition.drawingInfo.renderer",write:!1},"web-scene":{types:i.o,name:"layerDefinition.drawingInfo.renderer",write:!0}},name:"layerDefinition.drawingInfo.renderer",write:!0}})],A.prototype,"renderer",null),(0,n._)([(0,a.Cb)(R.YI)],A.prototype,"screenSizePerspectiveEnabled",void 0),(0,n._)([(0,a.Cb)({readOnly:!0})],A.prototype,"source",void 0),(0,n._)([(0,a.Cb)({readOnly:!0,type:m.Z,json:{origins:{service:{read:!0}}}})],A.prototype,"spatialReference",void 0),(0,n._)([(0,a.Cb)({type:String,json:{write:{enabled:!0,ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"collection.title"}}}})],A.prototype,"title",void 0),(0,n._)([(0,a.Cb)({readOnly:!0,json:{read:!1}})],A.prototype,"type",void 0),(0,n._)([(0,a.Cb)({type:String,readOnly:!0})],A.prototype,"typeIdField",void 0),(0,n._)([(0,a.Cb)({type:[_.Z]})],A.prototype,"types",void 0),(0,n._)([(0,a.Cb)(R.HQ)],A.prototype,"url",void 0),A=(0,n._)([(0,l.j)("esri.layers.OGCFeatureLayer")],A);const W=A},907:(e,t,o)=>{o.d(t,{g:()=>n});const n={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},12106:(e,t,o)=>{o.d(t,{O3:()=>S,lG:()=>F,my:()=>C,q9:()=>l});var n=o(64299),r=o(43637),i=o(5814),s=o(11004);const a={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};function l(e){return a[e]}function*p(e){switch(e.type){case"Feature":yield e;break;case"FeatureCollection":for(const t of e.features)t&&(yield t)}}function*u(e){if(!e)return null;switch(e.type){case"Point":yield e.coordinates;break;case"LineString":case"MultiPoint":yield*e.coordinates;break;case"MultiLineString":case"Polygon":for(const t of e.coordinates)yield*t;break;case"MultiPolygon":for(const t of e.coordinates)for(const e of t)yield*e}}function c(e){for(const t of e)if(t.length>2)return!0;return!1}function d(e){let t=0;for(let o=0;o<e.length;o++){const n=e[o],r=e[(o+1)%e.length];t+=n[0]*r[1]-r[0]*n[1]}return t<=0}function y(e){const t=e[0],o=e[e.length-1];return t[0]===o[0]&&t[1]===o[1]&&t[2]===o[2]||e.push(t),e}function f(e,t,o){switch(t.type){case"LineString":case"MultiPoint":return function(e,t,o){return h(e,t.coordinates,o),e}(e,t,o);case"MultiLineString":return function(e,t,o){for(const n of t.coordinates)h(e,n,o);return e}(e,t,o);case"MultiPolygon":return function(e,t,o){for(const n of t.coordinates){g(e,n[0],o);for(let t=1;t<n.length;t++)m(e,n[t],o)}return e}(e,t,o);case"Point":return function(e,t,o){return b(e,t.coordinates,o),e}(e,t,o);case"Polygon":return function(e,t,o){const n=t.coordinates;g(e,n[0],o);for(let r=1;r<n.length;r++)m(e,n[r],o);return e}(e,t,o)}}function g(e,t,o){const n=y(t);!function(e){return!d(e)}(n)?h(e,n,o):v(e,n,o)}function m(e,t,o){const n=y(t);!function(e){return d(e)}(n)?h(e,n,o):v(e,n,o)}function h(e,t,o){for(const n of t)b(e,n,o);e.lengths.push(t.length)}function v(e,t,o){for(let n=t.length-1;n>=0;n--)b(e,t[n],o);e.lengths.push(t.length)}function b(e,t,o){const[n,r,i]=t;e.coords.push(n,r),o.hasZ&&e.coords.push(i||0)}function w(e){switch(typeof e){case"string":return"esriFieldTypeString";case"number":return"esriFieldTypeDouble";default:return"unknown"}}function S(e){if(!e)throw new n.Z("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==e.type&&"FeatureCollection"!==e.type)throw new n.Z("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:e});const{crs:t}=e;if(!t)return;const o="string"==typeof t?t:"name"===t.type?t.properties.name:"EPSG"===t.type?t.properties.code:null,r=new RegExp(".*(CRS84H?|4326)$","i");if(!o||!r.test(o))throw new n.Z("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:t})}function C(e){var t;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[],r=new Set,i=new Set;let a,d=!1,y=null,f=!1,{geometryType:g=null}=o,m=!1;for(const v of p(e)){const{geometry:e,properties:t,id:o}=v;if((!e||(g||(g=l(e.type)),l(e.type)===g))&&(d||(d=c(u(e))),f||(f=null!=o,f&&(a=typeof o,y=Object.keys(t).filter((e=>t[e]===o)))),f&&null!=o&&(y.length>1?y=y.filter((e=>t[e]===o)):1===y.length&&(y=t[y[0]]===o?y:[])),!m&&t)){let e=!0;for(const o in t){if(r.has(o))continue;const a=t[o];if(null==a){e=!1,i.add(o);continue}const l=w(a);"unknown"!==l?(i.delete(o),r.add(o),n.push({name:(0,s.q6)(o),alias:o,type:l})):i.add(o)}m=e}}const h=(0,s.q6)(1===(null===(t=y)||void 0===t?void 0:t.length)&&y[0]||null);if(h)for(const l of n)if(l.name===h&&(0,s.H7)(l)){l.type="esriFieldTypeOID";break}return{fields:n,geometryType:g,hasZ:d,objectIdFieldName:h,objectIdFieldType:a,unknownFields:Array.from(i)}}function F(e,t){return Array.from(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const{geometryType:o,objectIdField:n}=t;for(const a of e){var s;const{geometry:e,properties:p,id:u}=a;if(e&&l(e.type)!==o)continue;const c=p||{};let d=null!==(s=c[n])&&void 0!==s?s:null;n&&null!=u&&!c[n]&&(c[n]=d=u);const y=new r.u_(e?f(new i.Z,e,t):null,c,null,d);yield y}}()}(p(e),t))}},42542:(e,t,o)=>{o.d(t,{Dm:()=>c,Hq:()=>d,MS:()=>y,bU:()=>l});var n=o(18489),r=o(34276),i=o(88034),s=o(907),a=o(32570);function l(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?a.I4:"esriGeometryPolyline"===e?a.ET:a.lF}}}const p=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let u=1;function c(e,t){if((0,r.Z)("esri-csp-restrictions"))return()=>(0,n.Z)({[t]:null},e);try{let o="this.".concat(t," = null;");for(const t in e)o+="this".concat(p.test(t)?".".concat(t):'["'.concat(t,'"]')," = ").concat(JSON.stringify(e[t]),";");const n=new Function("\n      return class AttributesClass$".concat(u++," {\n        constructor() {\n          ").concat(o,";\n        }\n      }\n    "))();return()=>new n}catch(o){return()=>(0,n.Z)({[t]:null},e)}}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:(0,i.d9)(e)}}]}function y(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0},query:s.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1}}}},13572:(e,t,o)=>{o.d(t,{$9:()=>w,G4:()=>F,Lu:()=>b,WW:()=>Z,d:()=>T,eS:()=>x,gp:()=>I,j:()=>C,w9:()=>S,yN:()=>j});var n=o(38244),r=o(18489),i=(o(75254),o(69279)),s=o(64299),a=o(92249),l=o(94452),p=o(95985),u=o(33917),c=o(55211),d=o(84512),y=o(12106),f=o(42542),g=o(19030),m=o(80663),h=o(74174);const v=a.Z.getLogger("esri.layers.graphics.sources.ogcfeature"),b="http://www.opengis.net/def/crs/",w="".concat(b,"OGC/1.3/CRS84");async function S(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const{links:a}=e,p=k(a,"items","application/geo+json")||k(a,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if((0,l.Wi)(p))throw new s.Z("ogc-feature-layer:missing-items-page","Missing items url");const{data:u}=await(0,i.default)(p.href,{signal:o.signal,query:(0,r.Z)((0,r.Z)({limit:n},o.customParameters),{},{token:o.apiKey}),headers:{accept:"application/geo+json"}});await(0,y.O3)(u);const c=(0,y.my)(u,{geometryType:t.geometryType}),d=t.fields||c.fields||[],h=null!=t.hasZ?t.hasZ:c.hasZ,b=c.geometryType,w=t.objectIdField||c.objectIdFieldName||"OBJECTID";let S=t.timeInfo;const C=d.find((e=>{let{name:t}=e;return t===w}));if(C)C.editable=!1,C.nullable=!1;else{if(!c.objectIdFieldType)throw new s.Z("ogc-feature-layer:missing-feature-id","Collection geojson require a feature id as a unique identifier");d.unshift({name:w,alias:w,type:"number"===c.objectIdFieldType?"esriFieldTypeOID":"esriFieldTypeString",editable:!1,nullable:!1})}if(w!==c.objectIdFieldName){const e=d.find((e=>{let{name:t}=e;return t===c.objectIdFieldName}));e&&(e.type="esriFieldTypeInteger")}d===c.fields&&c.unknownFields.length>0&&v.warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:c.unknownFields}});for(const r of d){if(null==r.name&&(r.name=r.alias),null==r.alias&&(r.alias=r.name),"esriFieldTypeOID"!==r.type&&"esriFieldTypeGlobalID"!==r.type&&(r.editable=null==r.editable||!!r.editable,r.nullable=null==r.nullable||!!r.nullable),!r.name)throw new s.Z("ogc-feature-layer:invalid-field-name","field name is missing",{field:r});if(!m.v.jsonValues.includes(r.type))throw new s.Z("ogc-feature-layer:invalid-field-type",'invalid type for field "'.concat(r.name,'"'),{field:r})}if(S){const e=new g.Z(d);if(S.startTimeField){const t=e.get(S.startTimeField);t?(S.startTimeField=t.name,t.type="esriFieldTypeDate"):S.startTimeField=null}if(S.endTimeField){const t=e.get(S.endTimeField);t?(S.endTimeField=t.name,t.type="esriFieldTypeDate"):S.endTimeField=null}if(S.trackIdField){const t=e.get(S.trackIdField);t?S.trackIdField=t.name:(S.trackIdField=null,v.warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:S}}))}S.startTimeField||S.endTimeField||(v.warn({name:"ogc-feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:S}}),S=null)}return{drawingInfo:b?(0,f.bU)(b):null,extent:P(e),geometryType:b,fields:d,hasZ:!!h,objectIdField:w,timeInfo:S}}async function C(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{links:o}=e,n=k(o,"data","application/json")||k(o,"http://www.opengis.net/def/rel/ogc/1.0/data","application/json");if((0,l.Wi)(n))throw new s.Z("ogc-feature-layer:missing-collections-page","Missing collections url");const{apiKey:a,customParameters:p,signal:u}=t,{data:c}=await(0,i.default)(n.href,{signal:u,headers:{accept:"application/json"},query:(0,r.Z)((0,r.Z)({},p),{},{token:a})});return c}async function F(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{links:o}=e,n=k(o,"conformance","application/json")||k(o,"http://www.opengis.net/def/rel/ogc/1.0/conformance","application/json");if((0,l.Wi)(n))throw new s.Z("ogc-feature-layer:missing-conformance-page","Missing conformance url");const{apiKey:a,customParameters:p,signal:u}=t,{data:c}=await(0,i.default)(n.href,{signal:u,headers:{accept:"application/json"},query:(0,r.Z)((0,r.Z)({},p),{},{token:a})});return c}async function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{apiKey:o,customParameters:n,signal:s}=t,{data:a}=await(0,i.default)(e,{signal:s,headers:{accept:"application/json"},query:(0,r.Z)((0,r.Z)({},n),{},{token:o})});return a}async function x(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o="application/vnd.oai.openapi+json;version=3.0",n=k(e.links,"service-desc",o);if((0,l.Wi)(n))return v.warn("ogc-feature-layer:missing-openapi-page","The OGC API-Features server does not have an OpenAPI page."),null;const{apiKey:s,customParameters:a,signal:p}=t,{data:u}=await(0,i.default)(n.href,{signal:p,headers:{accept:o},query:(0,r.Z)((0,r.Z)({},a),{},{token:s})});return u}function T(e){var t;const o=null===(t=(0,n.Z)(/^http:\/\/www\.opengis.net\/def\/crs\/(.*)\/(.*)\/(.*)$/i,{authority:1,version:2,code:3}).exec(e))||void 0===t?void 0:t.groups;if(!o)return null;const{authority:r,code:i}=o;switch(r.toLowerCase()){case"ogc":switch(i.toLowerCase()){case"crs27":return h.Z.GCS_NAD_1927.wkid;case"crs83":return 4269;case"crs84":case"crs84h":return h.Z.WGS84.wkid;default:return null}case"esri":case"epsg":{const e=Number.parseInt(i,10);return Number.isNaN(e)?null:e}default:return null}}async function j(e,t,o){const n=await Z(e,t,o);return(0,c.cn)(n)}async function Z(e,t,o){const{collection:n,layerDefinition:a,maxRecordCount:f,queryParameters:{apiKey:g,customParameters:m},spatialReference:v,supportedCrs:b}=e,{links:w}=n,S=k(w,"items","application/geo+json")||k(w,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if((0,l.Wi)(S))throw new s.Z("ogc-feature-layer:missing-items-page","Missing items url");const{geometry:C,num:F,start:I,timeExtent:x,where:T}=t;if(t.objectIds)throw new s.Z("ogc-feature-layer:query-by-objectids-not-supported","Queries with objectids are not supported");const j=h.Z.fromJSON(v),Z=(0,l.Pt)(t.outSpatialReference,j),_=Z.isWGS84?null:R(Z,b),P=O(C,b),D=function(e){if((0,l.Wi)(e))return null;const{start:t,end:o}=e;return"".concat((0,l.pC)(t)?t.toISOString():"..","/").concat((0,l.pC)(o)?o.toISOString():"..")}(x),G=(N=T,(0,l.Wi)(N)||!N||"1=1"===N?null:N),M=null!==F&&void 0!==F?F:null!=I&&void 0!==I?10:f,{data:q}=await(0,i.default)(S.href,(0,r.Z)((0,r.Z)({},o),{},{query:(0,r.Z)((0,r.Z)((0,r.Z)({},m),P),{},{crs:_,datetime:D,query:G,limit:M,startindex:I,token:g}),headers:{accept:"application/geo+json"}}));var N;let E=!1;if(q.links){E=!!q.links.find((e=>"next"===e.rel))}!E&&Number.isInteger(q.numberMatched)&&Number.isInteger(q.numberReturned)&&(E=q.numberReturned<q.numberMatched);const{fields:A,geometryType:W,hasZ:L,objectIdField:Q}=a,B=(0,y.lG)(q,{geometryType:W,hasZ:L,objectIdField:Q});if(!_&&Z.isWebMercator)for(const r of B)if((0,l.pC)(r.geometry)){const e=(0,c.di)(r.geometry,W,L,!1);e.spatialReference=h.Z.WGS84,r.geometry=(0,c.GH)((0,u.iV)(e,Z))}for(const r of B)r.objectId=r.attributes[Q];const H=_||!_&&Z.isWebMercator?Z.toJSON():p.Zn,J=new d.Z;return J.exceededTransferLimit=E,J.features=B,J.fields=A,J.geometryType=W,J.hasZ=L,J.objectIdFieldName=Q,J.spatialReference=H,J}function R(e,t){var o,n,r;const{isWebMercator:i,wkid:s}=e;if(!s)return null;const a=i?null!==(o=null!==(n=null!==(r=t[3857])&&void 0!==r?r:t[102100])&&void 0!==n?n:t[102113])&&void 0!==o?o:t[900913]:t[e.wkid];return a?"".concat(b).concat(a):null}function _(e){if((0,l.Wi)(e))return"";const{xmin:t,ymin:o,xmax:n,ymax:r}=e;return"".concat(t,",").concat(o,",").concat(n,",").concat(r)}function O(e,t){if(!function(e){return(0,l.pC)(e)&&"extent"===e.type}(e))return null;const{spatialReference:o}=e;if(!o||o.isWGS84)return{bbox:_(e)};const n=R(o,t);return(0,l.pC)(n)?{bbox:_(e),"bbox-crs":n}:o.isWebMercator?{bbox:_((0,u.iV)(e,h.Z.WGS84))}:null}function P(e){var t;const o=null===(t=e.extent)||void 0===t?void 0:t.spatial;if(!o)return null;const n=o.bbox[0],r=4===n.length,i=n[0],s=n[1],a=r?void 0:n[2];return{xmin:i,ymin:s,xmax:r?n[2]:n[3],ymax:r?n[3]:n[4],zmin:a,zmax:r?void 0:n[5],spatialReference:h.Z.WGS84.toJSON()}}function k(e,t,o){return e.find((e=>e.rel===t&&e.type===o))||e.find((e=>e.rel===t&&!e.type))}},38244:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(29675);function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}function i(){i=function(e,t){return new o(e,void 0,t)};var e=RegExp.prototype,t=new WeakMap;function o(e,n,i){var s=new RegExp(e,n);return t.set(s,i||t.get(e)),r(s,o.prototype)}function s(e,o){var n=t.get(o);return Object.keys(n).reduce((function(t,o){var r=n[o];if("number"==typeof r)t[o]=e[r];else{for(var i=0;void 0===e[r[i]]&&i+1<r.length;)i++;t[o]=e[r[i]]}return t}),Object.create(null))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)}(o,RegExp),o.prototype.exec=function(t){var o=e.exec.call(this,t);if(o){o.groups=s(o,this);var n=o.indices;n&&(n.groups=s(n,this))}return o},o.prototype[Symbol.replace]=function(o,r){if("string"==typeof r){var i=t.get(this);return e[Symbol.replace].call(this,o,r.replace(/\$<([^>]+)>/g,(function(e,t){var o=i[t];return"$"+(Array.isArray(o)?o.join("$"):o)})))}if("function"==typeof r){var a=this;return e[Symbol.replace].call(this,o,(function(){var e=arguments;return"object"!=(0,n.Z)(e[e.length-1])&&(e=[].slice.call(e)).push(s(e,a)),r.apply(this,e)}))}return e[Symbol.replace].call(this,o,r)},i.apply(this,arguments)}}}]);
//# sourceMappingURL=4383.29ee6667.chunk.js.map
"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[52824],{52824:(t,e,s)=>{s.r(e),s.d(e,{Solution:()=>v});var i=s(12554);class n{static add(t,e){return new n(t.x+e.x,t.y+e.y,t.z+e.z)}static subtract(t,e){return new n(t.x-e.x,t.y-e.y,t.z-e.z)}static distance(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)+(t.z-e.z)*(t.z-e.z))}static deepCopy(t){return new n(t.x,t.y,t.z)}constructor(t,e,s){this.x=void 0,this.y=void 0,this.z=void 0,this.x=t,this.y=e,this.z=s}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){let t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);this.x/=t,this.y/=t,this.z/=t}}const a=(t,e,s)=>{let{x:i,y:n}=s;return{x:i,y:n}},d=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://raw.githubusercontent.com/NamjuLee/data/master/img/person/HaminHaram.jpg";return new Promise(((e,s)=>{let i=new Image;i.onload=()=>{e(i),i.onload=null,i=null},i.onerror=t=>{s(t)},i.src=t}))};class o{constructor(t){this.solution=void 0,this.canvas=void 0,this.statusRendering=void 0,this.statusTarget=new n(200,200,4),this.needInterpolation=!1,this.img=void 0,this.ctx=void 0,this.speedInterpolation=.1,this.easingInterpolation=!0,this.solution=t,this.canvas=document.createElement("canvas"),this.canvas.style.background="#111",this.canvas.width=1200,this.canvas.height=800,t.div.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.statusRendering=new n(0,0,1);let e=new n(0,0,1),s=new n(0,0,1),o=!1;this.canvas.addEventListener("mousedown",(t=>{const{offsetX:e,offsetY:i}=t;s.x=e,s.y=i,s.z>2&&(o=!0)})),this.canvas.addEventListener("mouseup",(t=>{if(!o)return;const{offsetX:i,offsetY:n}=t,a=i-s.x,d=n-s.y;e.x+=a,e.y+=d,o=!1})),this.canvas.addEventListener("wheel",(t=>{const{offsetX:i,offsetY:n,deltaY:d}=t,o=d<0?1:-1;s.z+=.2*o,s.z<.2?s.z=.2:s.z>5&&(s.z=5);const{x:h,y:r}=((t,e,s,i)=>{let{x:n,y:d}=s;const o=1!==e,h=o?(n+Math.abs(i.x))/i.z:n,r=o?(d+Math.abs(i.y))/i.z:d;return{...a(t,e,{x:h-h*e+(n-h),y:r-r*e+(d-r)})}})(this.canvas,s.z,{x:i,y:n},e);e.x=h,e.y=r,e.z=s.z,this.statusRendering.x=h,this.statusRendering.y=r,this.statusRendering.z=s.z})),this.canvas.addEventListener("mousemove",(t=>{if(!o)return;const{offsetX:i,offsetY:n}=t,d=e.x+(i-s.x),h=e.y+(n-s.y),{x:r,y:l}=a(this.canvas,e.z,{x:d,y:h});this.statusRendering.x=r,this.statusRendering.y=l,this.statusRendering.z=e.z})),console.log(i.xf.url),i.xf.url?(console.log(i.xf.url),d(i.xf.url).then((t=>{this.img=t}))):d().then((t=>{this.img=t})),this.render()}render(){var t,e,s;requestAnimationFrame((()=>{this.render()})),this.needInterpolation&&(this.easingInterpolation?(this.statusRendering=r(this.statusRendering,this.statusTarget,this.speedInterpolation),n.distance(this.statusRendering,this.statusTarget)<1&&(this.statusRendering.x=this.statusTarget.x,this.statusRendering.y=this.statusTarget.y,this.statusRendering.z=this.statusTarget.z,this.needInterpolation=!1)):(this.statusRendering=h(this.statusRendering,this.statusTarget,this.speedInterpolation),n.distance(this.statusRendering,this.statusTarget)<150*this.speedInterpolation&&(this.statusRendering.x=this.statusTarget.x,this.statusRendering.y=this.statusTarget.y,this.statusRendering.z=this.statusTarget.z,this.needInterpolation=!1))),t=this.ctx,e=this.img,s=this.statusRendering,t.clearRect(0,0,t.canvas.width,t.canvas.height),t.save(),void 0!==s&&(t.translate(s.x,s.y),t.scale(s.z,s.z)),void 0!==e&&t.drawImage(e,0,0,e.width,e.height),t.restore()}}const h=function(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const i=n.subtract(e,t);return i.normalize(),new n(t.x+i.x*s*150,t.y+i.y*s*150,t.z+i.z*s*150)},r=function(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const i=n.subtract(e,t);return new n(t.x+i.x*s,t.y+i.y*s,t.z+i.z*s)};class l{constructor(t){this.solution=void 0,this.div=void 0,this.currentIndex=-1,this.timeline=[],this.divFrameNum=void 0,this.solution=t,this.div=document.createElement("div"),this.solution.div.appendChild(this.div);const e=document.createElement("div");e.style.display="flex",this.div.appendChild(e);const s=document.createElement("div");e.appendChild(s),s.textContent="Create Key",s.style.width="100px",s.style.color="aqua",s.onclick=()=>{this.timeline.push(n.deepCopy(t.canvasImage.statusRendering)),this.currentIndex=this.timeline.length-1,this.updateFrameNumber()};const i=document.createElement("div");e.appendChild(i),i.textContent="Update Key",i.style.width="100px",i.style.color="aqua",i.onclick=()=>{this.timeline[this.currentIndex]=n.deepCopy(t.canvasImage.statusRendering)};const a=document.createElement("div");e.appendChild(a),a.textContent="<<<",a.style.paddingRight="20px",a.style.color="aqua",a.onclick=()=>{this.currentIndex--,this.currentIndex<0&&(this.currentIndex=0),this.updateTarget(),this.updateFrameNumber()};const d=document.createElement("div");e.appendChild(d),d.textContent=">>>",d.style.color="aqua",d.onclick=()=>{this.currentIndex++,this.currentIndex>this.timeline.length-1&&(this.currentIndex=this.timeline.length-1),this.updateTarget(),this.updateFrameNumber()};const o=document.createElement("div");this.div.appendChild(o),o.textContent="Play",o.style.color="aqua",o.onclick=()=>{this.solution.canvasImage.needInterpolation=!this.solution.canvasImage.needInterpolation};let h=m("Easing Interpolation");this.div.append(h.div),h.checkBox.checked=!0,h.checkBox.onchange=()=>{!0===h.checkBox.checked?this.solution.canvasImage.easingInterpolation=!0:this.solution.canvasImage.easingInterpolation=!1};let r=u("Speed","0","100");r.text.textContent="Speed: ",this.div.append(r.div),r.slider.oninput=()=>{const t=+(.001*+r.slider.value+.03).toFixed(3);r.text.textContent="Speed: "+t,this.solution.canvasImage.speedInterpolation=t},this.divFrameNum=document.createElement("div"),this.divFrameNum.style.display="flex",this.div.appendChild(this.divFrameNum),this.updateFrameNumber();const l=document.createElement("p");l.textContent="https://raw.githubusercontent.com/NamjuLee/data/master/img/worldmap/worldMap_03.jpg",this.div.append(l)}updateFrameNumber(){for(;this.divFrameNum.lastElementChild;)this.divFrameNum.removeChild(this.divFrameNum.lastElementChild);for(let t=0;t<this.timeline.length;++t)this.currentIndex===t?this.divFrameNum.appendChild(c(t,"aqua")):this.divFrameNum.appendChild(c(t,"#999"))}updateTarget(){this.solution.canvasImage.statusTarget=new n(this.timeline[this.currentIndex].x,this.timeline[this.currentIndex].y,this.timeline[this.currentIndex].z),this.solution.canvasImage.needInterpolation=!0}}const c=(t,e)=>{const s=document.createElement("p");return s.textContent=" ".concat(t," "),s.style.paddingRight="10px",s.style.color=e,s},u=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"2009",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"2015";const i=document.createElement("div");i.style.display="flex";const n=document.createElement("input");n.type="range",n.min=e,n.max=s;const a=document.createElement("div");return a.textContent=t,a.style.color="#aaa",i.appendChild(n),i.appendChild(a),{div:i,slider:n,text:a}},m=t=>{const e=document.createElement("div");e.style.display="flex";const s=document.createElement("input");s.type="checkbox",s.defaultChecked=!1;const i=document.createElement("div");return i.textContent=t,i.style.color="#aaa",e.appendChild(s),e.appendChild(i),{div:e,checkBox:s}};class v{constructor(t){this.divHost=void 0,this.div=void 0,this.canvasImage=void 0,this.controller=void 0,this.divHost=document.getElementById(t),this.divHost.style.display="flex",this.divHost.style.alignItems="center",this.div=document.createElement("div"),this.divHost.appendChild(this.div),this.div.style.marginLeft="auto",this.div.style.marginRight="auto",this.div.style.backgroundColor="#555",this.div.style.width="1000px",this.div.style.height="800px",this.canvasImage=new o(this),this.controller=new l(this)}destroy(){for(;this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}}}}]);
//# sourceMappingURL=52824.3acd9c46.chunk.js.map
"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[62680],{75871:(e,t,r)=>{r.d(t,{B:()=>h});var o=r(18489),i=r(81722),n=r(83689),s=r(45813),a=r(65938),p=r(26502),l=r(90754);function c(e){return d[function(e){return e instanceof Blob?e.type:function(e){const t=(0,n.Ml)(e);return m[t]||u}(e.url)}(e)]||y}const d={},u="text/plain",y=d[u],m={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const S in m)d[m[S]]=S;var f=r(72511);function h(e){var t;const r=null!==(t=null===e||void 0===e?void 0:e.origins)&&void 0!==t?t:[void 0];return(t,s)=>{const d=function(e,t,r){var s;if("resource"===(null===e||void 0===e?void 0:e.type))return function(e,t,r){const s=(0,a.VZ)(t,r);return{type:String,read:(e,t,r)=>{const o=(0,f.r)(e,t,r);return s.type===String?o:"function"==typeof s.type?new s.type({url:o}):void 0},write:{writer(t,a,l,d){if(!d||!d.resources)return"string"==typeof t?void(a[l]=(0,f.t)(t,d)):void(a[l]=t.write({},d));const u=function(e){return null==e?null:"string"==typeof e?e:e.url}(t),y=(0,f.t)(u,(0,o.Z)((0,o.Z)({},d),{},{verifyItemRelativeUrls:d&&d.verifyItemRelativeUrls?{writtenUrls:d.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0}),f.M.NO),m=s.type!==String&&(!(0,i.l)(this)||d&&d.origin&&this.originIdOf(r)>(0,p.M9)(d.origin)),h={object:this,propertyName:r,value:t,targetUrl:y,dest:a,targetPropertyName:l,context:d,params:e};d&&d.portalItem&&y&&!(0,n.YP)(y)?m?function(e){var t;const{context:r,targetUrl:i,params:s,value:a,dest:p,targetPropertyName:l}=e;if(!r.portalItem)return;const d=r.portalItem.resourceFromPath(i),u=w(a,i,r),y=c(u),m=(0,n.Ml)(d.path),f=null!==(t=null===s||void 0===s?void 0:s.compress)&&void 0!==t&&t;y===m?(r.resources&&g((0,o.Z)((0,o.Z)({},e),{},{resource:d,content:u,compress:f,updates:r.resources.toUpdate})),p[l]=i):v(e)}(h):function(e){let{context:t,targetUrl:r,dest:o,targetPropertyName:i}=e;t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(r),compress:!1}),o[i]=r)}(h):d&&d.portalItem&&(null==y||null!=(0,f.i)(y)||(0,n.jc)(y)||m)?v(h):a[l]=y}}}}(e,t,r);switch(null!==(s=null===e||void 0===e?void 0:e.type)&&void 0!==s?s:"other"){case"other":return{read:!0,write:!0};case"url":{const{read:e,write:t}=f.a;return{read:e,write:t}}}}(e,t,s);for(const e of r){const r=(0,l.CJ)(t,e,s);for(const e in d)r[e]=d[e]}}}function v(e){var t,i,a;const{targetUrl:p,params:l,value:d,context:u,dest:y,targetPropertyName:m}=e;if(!u.portalItem)return;const h=(0,f.p)(p),v=null!==(t=null===h||void 0===h?void 0:h.filename)&&void 0!==t?t:(0,s.D)(),S=null!==(i=null===l||void 0===l?void 0:l.prefix)&&void 0!==i?i:null===h||void 0===h?void 0:h.prefix,_=w(d,p,u),b=(0,n.v_)(S,v),x="".concat(b,".").concat(c(_)),I=u.portalItem.resourceFromPath(x);(0,n.jc)(p)&&u.resources&&u.resources.pendingOperations.push(async function(e){const t=(await Promise.resolve().then(r.bind(r,69279))).default,{data:o}=await t(e,{responseType:"blob"});return o}(p).then((e=>{I.path="".concat(b,".").concat(c(e)),y[m]=I.itemRelativeUrl})).catch((()=>{})));const N=null!==(a=null===l||void 0===l?void 0:l.compress)&&void 0!==a&&a;u.resources&&g((0,o.Z)((0,o.Z)({},e),{},{resource:I,content:_,compress:N,updates:u.resources.toAdd})),y[m]=I.itemRelativeUrl}function g(e){let{object:t,propertyName:r,updates:o,resource:i,content:n,compress:s}=e;o.push({resource:i,content:n,compress:s,finish:e=>{!function(e,t,r){"string"==typeof e[t]?e[t]=r.url:e[t].url=r.url}(t,r,e)}})}function w(e,t,r){return"string"==typeof e?{url:t}:new Blob([JSON.stringify(e.toJSON(r))],{type:"application/json"})}},62680:(e,t,r)=>{r.r(t),r.d(t,{default:()=>B});var o,i=r(18489),n=r(78808),s=r(64299),a=r(34136),p=r(94452),l=r(5674),c=r(3341),d=r(51654),u=r(90754),y=(r(83194),r(75476),r(65916)),m=r(90825),f=r(75871),h=r(63573),v=r(79017),g=r(86272),w=r(33298),S=r(50138),_=r(91466),b=r(50336),x=r(53815),I=r(51192),N=r(69279),Z=r(75468),O=r(34178),C=r(83689),T=(r(75254),r(88034)),U=r(56896),j=r(9422),R=r(62348),M=r(13925);let P=o=class extends O.wq{constructor(e){super(e),this.geometry=null,this.type="clip"}writeGeometry(e,t,r,o){if(o.layer&&o.layer.spatialReference&&!o.layer.spatialReference.equals(this.geometry.spatialReference)){if(!(0,R.Up)(e.spatialReference,o.layer.spatialReference))return void(o&&o.messages&&o.messages.push(new U.Z("scenemodification:unsupported","Scene modifications with incompatible spatial references are not supported",{modification:this,spatialReference:o.layer.spatialReference,context:o})));const i=new M.Z;(0,R.Wt)(e,i,o.layer.spatialReference),t[r]=i.toJSON(o)}else t[r]=e.toJSON(o);delete t[r].spatialReference}clone(){return new o({geometry:(0,T.d9)(this.geometry),type:this.type})}};(0,n._)([(0,u.Cb)({type:M.Z}),(0,f.B)()],P.prototype,"geometry",void 0),(0,n._)([(0,j.c)(["web-scene","portal-item"],"geometry")],P.prototype,"writeGeometry",null),(0,n._)([(0,u.Cb)({type:["clip","mask","replace"],nonNullable:!0}),(0,f.B)()],P.prototype,"type",void 0),P=o=(0,n._)([(0,m.j)("esri.layers.support.SceneModification")],P);const L=P;var J;let V=J=class extends((0,O.eC)(Z.Z.ofType(L))){constructor(e){super(e),this.url=null}clone(){return new J({url:this.url,items:this.items.map((e=>e.clone()))})}toJSON(e){return this.toArray().map((t=>t.toJSON(e))).filter((e=>!!e.geometry))}static fromJSON(e,t){const r=new J;for(const o of e)r.add(L.fromJSON(o,t));return r}static async fromUrl(e,t,r){const o={url:(0,C.mN)(e),origin:"service"},n=await(0,N.default)(e,{responseType:"json",signal:(0,p.U2)(r,"signal")}),s=t.toJSON(),a=[];for(const p of n.data)a.push(L.fromJSON((0,i.Z)((0,i.Z)({},p),{},{geometry:(0,i.Z)((0,i.Z)({},p.geometry),{},{spatialReference:s})}),o));return new J({url:e,items:a})}};(0,n._)([(0,u.Cb)({type:String})],V.prototype,"url",void 0),V=J=(0,n._)([(0,m.j)("esri.layers.support.SceneModifications")],V);const A=V;var z=r(72511);let D=class extends((0,b.Vt)((0,g.Y)((0,w.q)((0,S.I)((0,_.M)((0,l.R)((0,v.V)(h.Z)))))))){constructor(){super(...arguments),this._handles=new a.Z,this.geometryType="mesh",this.operationalLayerType="IntegratedMeshLayer",this.type="integrated-mesh",this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.profile="mesh-pyramids",this.modifications=null,this._modificationsSource=null,this.elevationInfo=null,this.path=null}destroy(){this._handles.destroy()}initialize(){this._handles.add((0,d.on)((()=>this.modifications),"after-changes",(()=>this.modifications=this.modifications),d.Z_))}normalizeCtorArgs(e,t){return"string"==typeof e?(0,i.Z)({url:e},t):e}readModifications(e,t,r){this._modificationsSource={url:(0,z.f)(e,r),context:r}}async load(e){return this.addResolvingPromise(this._doLoad(e)),this}async _doLoad(e){const t=(0,p.U2)(e,"signal");try{await this.loadFromPortal({supportedTypes:["Scene Service"]},e)}catch(r){(0,c.r9)(r)}if(await this._fetchService(t),(0,p.pC)(this._modificationsSource)){const t=await A.fromUrl(this._modificationsSource.url,this.spatialReference,e);this.setAtOrigin("modifications",t,this._modificationsSource.context.origin),this._modificationsSource=null}await this._fetchIndexAndUpdateExtent(this.nodePages,t)}beforeSave(){if(!(0,p.Wi)(this._modificationsSource))return this.load().then((()=>{}),(()=>{}))}async saveAs(e,t){return this._debouncedSaveOperations(b.xp.SAVE_AS,(0,i.Z)((0,i.Z)({},t),{},{getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"integrated-mesh"}),e)}async save(){const e={getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"integrated-mesh"};return this._debouncedSaveOperations(b.xp.SAVE,e)}validateLayer(e){if(e.layerType&&"IntegratedMesh"!==e.layerType)throw new s.Z("integrated-mesh-layer:layer-type-not-supported","IntegratedMeshLayer does not support this layer type",{layerType:e.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new s.Z("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"});if(this.version.major>1)throw new s.Z("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x"})}_getTypeKeywords(){return["IntegratedMeshLayer"]}};(0,n._)([(0,u.Cb)({type:String,readOnly:!0})],D.prototype,"geometryType",void 0),(0,n._)([(0,u.Cb)({type:["show","hide"]})],D.prototype,"listMode",void 0),(0,n._)([(0,u.Cb)({type:["IntegratedMeshLayer"]})],D.prototype,"operationalLayerType",void 0),(0,n._)([(0,u.Cb)({json:{read:!1},readOnly:!0})],D.prototype,"type",void 0),(0,n._)([(0,u.Cb)({type:I.U4,readOnly:!0})],D.prototype,"nodePages",void 0),(0,n._)([(0,u.Cb)({type:[I.QI],readOnly:!0})],D.prototype,"materialDefinitions",void 0),(0,n._)([(0,u.Cb)({type:[I.Yh],readOnly:!0})],D.prototype,"textureSetDefinitions",void 0),(0,n._)([(0,u.Cb)({type:[I.H3],readOnly:!0})],D.prototype,"geometryDefinitions",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],D.prototype,"serviceUpdateTimeStamp",void 0),(0,n._)([(0,u.Cb)({type:A}),(0,f.B)({origins:["web-scene","portal-item"],type:"resource",prefix:"modifications"})],D.prototype,"modifications",void 0),(0,n._)([(0,y.r)(["web-scene","portal-item"],"modifications")],D.prototype,"readModifications",null),(0,n._)([(0,u.Cb)(x.PV)],D.prototype,"elevationInfo",void 0),(0,n._)([(0,u.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0},"portal-item":{read:!0,write:!0}},read:!1}})],D.prototype,"path",void 0),D=(0,n._)([(0,m.j)("esri.layers.IntegratedMeshLayer")],D);const B=D}}]);
//# sourceMappingURL=62680.af4ff461.chunk.js.map
"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[75002],{75002:(e,t,o)=>{o.r(t),o.d(t,{Solution:()=>_});var r=o(1250),a=o(18489),s=o(5483),n=o.n(s),i=o(34648),l=o(72791),c=o(28733),d=o(27751);var u=o(80184);const p=e=>{let{mapRef:t}=e;return(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{children:"menu"}),(0,u.jsx)(d.ZP,{type:"text",onClick:e=>{const o=t.getCanvas();var r;(r=t,new Promise((function(e,t){r.once("render",(function(){e(r.getCanvas().toDataURL())})),r.setBearing(r.getBearing())}))).then((e=>{const t=new Image;t.width=o.width,t.height=o.height,t.src=e;const r=document.createElement("a");r.download="fileName.png",r.href=e,r.click()}))},children:"capture"})]})};o(43161);const h="style_mapContainer__VmRBv",f="style_menu__OZNbn",v=()=>{const e=(0,l.useRef)(),[t,o]=(0,l.useState)(null);(0,l.useEffect)((()=>{(async()=>{try{const e=await fetch("/njs-lab-public/static/dataDummyReady/presidential_election_county_summary_bead.csv");if(!e.ok)throw new Error("Failed to load csv data");const t=await e.text(),r=(0,c.Kw)(t);o(r)}catch(e){console.error("Error fetching GeoJSON:",e)}})()}),[]);const r=(0,l.useCallback)((e=>{if(e<0||e>1)throw new Error("Input must be between 0 and 1.");return[Math.round(255*(1-e)),0,Math.round(255*e)]}),[]),s=(0,l.useCallback)((e=>{const o=t.find((t=>t.county_fips.toString().padStart(5,"0")===e));return o?{colorData:parseFloat(o.vote_per_D)||0,vote_per_D:o.vote_per_D,vote_per_R:o.vote_per_R,loc_pct_served:parseFloat(o.loc_pct_served)||0}:null}),[t]),[d,v]=(0,l.useState)(null),_=(0,l.useCallback)((e=>{const t=e.features&&e.features[0];v(t?(0,a.Z)((0,a.Z)({},t.properties),{},{longitude:e.lngLat.lng,latitude:e.lngLat.lat}):null)}),[]),m=(0,l.useCallback)((e=>{var t;e.target.queryRenderedFeatures(e.point);null===e||void 0===e||null===(t=e.features)||void 0===t||t.length}),[]);(0,l.useEffect)((()=>{(async()=>{try{const e=await fetch("/njs-lab-public/static/dataDummyReady/underserved_locations.geojson");if(!e.ok)throw new Error("Failed to load GeoJSON data");const t=await e.json();y(t)}catch(e){console.error("Error fetching GeoJSON:",e)}})()}),[]),(0,l.useEffect)((()=>{(async()=>{try{const e=await fetch("/njs-lab-public/static/data/us_counties.geojson");if(!e.ok)throw new Error("Failed to load GeoJSON data");const t=await e.json();x(t)}catch(e){console.error("Error fetching GeoJSON:",e)}})()}),[]);const[g,y]=(0,l.useState)({type:"FeatureCollection",features:[]}),w="my-layer-circle",j={id:w,type:"circle",paint:{"circle-radius":6,"circle-color":"#4E3FC8","circle-opacity":.8,"circle-stroke-width":2,"circle-stroke-color":"#fff"}},[b,x]=(0,l.useState)({type:"FeatureCollection",features:[]}),E="polygon-layer",k={id:E,type:"fill",paint:{"fill-color":["rgba",["get","R"],["get","G"],["get","B"],["get","O"]],"fill-opacity":.5,"fill-outline-color":"#000"}},C=(0,l.useMemo)((()=>(0,a.Z)((0,a.Z)({},b),{},{features:b.features.map((e=>{const t=s(e.properties.GEOID);if(!t)return e;const o=parseFloat(t.vote_per_R),n=parseFloat(t.vote_per_D),i=r(n/(o+n));return(0,a.Z)((0,a.Z)({},e),{},{properties:(0,a.Z)((0,a.Z)({},e.properties),{},{R:i[0],G:0,B:i[2],O:1-Math.min(t.loc_pct_served**2*1.5*1e-4,1),loc_pct_served:t.loc_pct_served,vote_per_D:t.vote_per_D,vote_per_R:t.vote_per_R})})}))})),[b,s,r,1.5]);return(0,u.jsxs)("div",{className:h,children:[(0,u.jsx)("div",{className:f,children:(0,u.jsx)(p,{mapRef:e.current})}),(0,u.jsx)(l.Suspense,{children:(0,u.jsxs)(i.ZP,{mapLib:n(),ref:e,initialViewState:{longitude:-100,latitude:40,zoom:3.5},style:{width:"100%",height:"100%",position:"relative",top:0,left:0,right:0,bottom:0,zIndex:0,flex:1},mapStyle:"mapbox://styles/mapbox/dark-v10",mapboxAccessToken:"pk.eyJ1IjoiZGVzaWduanUiLCJhIjoiY2xhNGU0YWo4MDlhYzNwdHBwenVvang4eiJ9.P3sX4l_3KjdPeRRbVS1VVg",dragRotate:!1,interactiveLayerIds:[w],onMouseMove:_,onClick:m,children:[(0,u.jsx)(i.Hw,{id:w,type:"geojson",data:g,children:(0,u.jsx)(i.mh,(0,a.Z)({},j))}),(0,u.jsx)(i.Hw,{id:E,type:"geojson",data:C,children:(0,u.jsx)(i.mh,(0,a.Z)({},k))}),d&&(0,u.jsx)(i.GI,{longitude:d.longitude,latitude:d.latitude,offset:[0,-15],closeButton:!1,className:"z-10",children:(0,u.jsxs)("div",{className:"p-2",children:[(0,u.jsx)("h3",{className:"font-bold",children:d.NAME}),(0,u.jsxs)("p",{children:["GEOID: ",JSON.stringify(d)]})]})})]})})]})};class _{constructor(e){this.divHost=void 0,this.divHost=document.getElementById(e);const t=document.createElement("div");t.style.height="100%",t.style.width="100%",this.divHost.appendChild(t);r.createRoot(t).render(l.createElement(v,{}))}destroy(){try{for(;this.divHost&&this.divHost.lastElementChild;){const e=this.divHost.lastElementChild;this.divHost.removeChild(e)}}catch(e){console.error("Error removing child elements:",e)}}}}}]);
//# sourceMappingURL=75002.3c9162bf.chunk.js.map
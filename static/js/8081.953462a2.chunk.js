"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[8081],{8081:(t,e,i)=>{i.r(e),i.d(e,{BindingNNA:()=>g});class n{constructor(t){this.window=void 0,this.window=t}addIconTopPanel(t){let e=document.createElement("button");e.style.width="".concat(t.width,"px"),e.style.zIndex="13;",e.style.position="relative",e.style.border="none",e.textContent=t.text,e.onclick=()=>t.callBack(),this.window.builder.divFulldownArea.appendChild(e)}addToggleTopPanel(t){let e=document.createElement("button");e.style.width="".concat(t.width,"px"),e.style.zIndex="13;",e.style.position="relative",e.style.border="none",e.textContent=t.text,e.onclick=()=>t.callBack(),this.window.builder.divFulldownArea.appendChild(e)}addIconLeftPanel(t){let e=document.createElement("button");e.style.height="50px",e.style.width="50px",e.style.zIndex="13;",e.style.position="relative",e.style.border="none",e.style.color="#000000",e.style.background="#fafafa",e.textContent=t.text,e.onclick=()=>t.callBack(),e.onmouseenter=()=>{e.style.color="#ffffff",e.style.background="#888888"},e.onmouseleave=()=>{e.style.color="#000000",e.style.background="#fafafa"},this.window.builder.divLeftUI.appendChild(e)}addIconLeft(){}}class s{constructor(t){this.window=void 0,this.divMain=void 0,this.divMainBody=void 0,this.divTopArea=void 0,this.divFulldownArea=void 0,this.divLeftUI=void 0,this.divBottomArea=void 0,this.divForGraphicContext=void 0,this.colorTopMenu="#dfdfdf",this.colorBGmenu="#f3f3f3",this.window=t}initPanel(t){this.initDivMain(),this.initDivTopArea(),this.initDivFulldownArea();const e=document.createElement("div");e.style.float="left",e.style.height="100%",e.style.padding="10px",e.style.background="#ff0000",this.divTopArea.appendChild(e);const i=document.createElement("div");i.style.float="left",i.style.padding="10px",i.textContent=t,this.divTopArea.appendChild(i),this.initDivContextArea(),this.initDivLeftArea(),this.divForGraphicContext=document.createElement("div"),this.divForGraphicContext.style.height="100%",this.divForGraphicContext.id="divForGraphicContext",this.divMainBody.appendChild(this.divForGraphicContext);const n=document.createElement("button");n.style.top="0px",n.style.left="0px",n.style.height="20px",n.style.width="20px",n.style.zIndex="13",n.style.float="right",n.style.padding="0px",n.style.zIndex="20",n.textContent="X",n.onclick=()=>{this.window.remove()},this.divTopArea.appendChild(n),this.initBottomArea(this.divMain);const s=document.createElement("div");s.style.height="100%",s.style.width="100px",s.style.float="left",this.divBottomArea.appendChild(s);const a=document.createElement("div");a.style.height="100%",a.style.width="80%",a.style.float="left",this.divBottomArea.appendChild(a)}initDivTopArea(){let t=document.createElement("div");t.style.width="100%",t.style.height="40px",t.style.background=this.colorTopMenu,t.style.zIndex="11";let e=!1,i=[0,0];t.ondrag=t=>{},t.onmouseenter=t=>{},t.ondrag=t=>{},t.onmousemove=t=>{if(e){const e=t.clientX-i[0],n=t.clientY-i[1];this.divMain.style.top=parseFloat(this.divMain.style.top)+n+"px",this.divMain.style.left=parseFloat(this.divMain.style.left)+e+"px",i[0]=t.clientX,i[1]=t.clientY}},t.onmousedown=t=>{i[0]=t.clientX,i[1]=t.clientY,e=!0,this.window.updateZindex()},t.onmouseup=t=>{e=!1},t.onmouseout=t=>{if(e){const e=t.clientX-i[0],n=t.clientY-i[1];this.divMain.style.top=parseFloat(this.divMain.style.top)+n+"px",this.divMain.style.left=parseFloat(this.divMain.style.left)+e+"px",i[0]=t.clientX,i[1]=t.clientY}},this.divTopArea=t,this.divMain.appendChild(t)}appendCloseTop(){}initBottomArea(t){let e=document.createElement("div");e.style.top=parseFloat(t.style.height)-parseFloat(t.style.top)-10+"px",e.style.width="100%",e.style.height="40px",e.style.background=this.colorBGmenu,e.style.zIndex="11";let i=!1,n=[0,0];e.ondrag=t=>{},e.onmouseenter=t=>{},e.ondrag=t=>{},e.onmousemove=s=>{if(i){const i=s.clientX-n[0],a=s.clientY-n[1];t.style.width=parseFloat(t.style.width)+i+"px",t.style.height=parseFloat(t.style.height)+a+"px",e.style.top=parseFloat(e.style.top)+a+"px",e.style.left=parseFloat(e.style.left)+i+"px",n[0]=s.clientX,n[1]=s.clientY}},e.onmousedown=t=>{n[0]=t.clientX,n[1]=t.clientY,i=!0},e.onmouseup=t=>{i=!1},e.onmouseout=s=>{if(this.window.updateResize=setTimeout((()=>{if(i){const i=s.clientX-n[0],a=s.clientY-n[1];t.style.width=parseFloat(t.style.width)+i+"px",t.style.height=parseFloat(t.style.height)+a+"px",e.style.top=parseFloat(e.style.top)+a+"px",e.style.left=parseFloat(e.style.left)+i+"px",n[0]=s.clientX,n[1]=s.clientY}}),300),i){const i=s.clientX-n[0],a=s.clientY-n[1];t.style.width=parseFloat(t.style.width)+i+"px",t.style.height=parseFloat(t.style.height)+a+"px",e.style.top=parseFloat(e.style.top)+a+"px",e.style.left=parseFloat(e.style.left)+i+"px",n[0]=s.clientX,n[1]=s.clientY}},this.divBottomArea=e,t.appendChild(e)}initDivMain(){this.divMain=document.createElement("div"),this.divMain.style.width="".concat(this.window.width,"px"),this.divMain.style.height="".concat(this.window.height,"px"),this.divMain.style.position="absolute",this.divMain.style.zIndex="10",this.divMain.id="NWindow",this.divMain.style.top="100px",this.divMain.style.left="200px",this.window.divHost.appendChild(this.divMain)}initDivFulldownArea(){this.divFulldownArea=document.createElement("div"),this.divFulldownArea.style.height="50px",this.divFulldownArea.style.width="100%",this.divFulldownArea.style.background=this.colorBGmenu,this.divMain.appendChild(this.divFulldownArea)}initDivContextArea(){this.divMainBody=document.createElement("div"),this.divMainBody.style.height="100%",this.divMainBody.style.width="100%",this.divMainBody.id="divContext",this.divMain.appendChild(this.divMainBody)}initDivLeftArea(){this.divLeftUI=document.createElement("div"),this.divLeftUI.style.height="100%",this.divLeftUI.style.width="100px",this.divLeftUI.style.background=this.colorBGmenu,this.divLeftUI.style.float="left",this.divMainBody.appendChild(this.divLeftUI)}}class a{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"NJS Sandbox",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:600,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:400;this.divHost=void 0,this.updateResize=void 0,this.width=600,this.height=400,this.controller=void 0,this.builder=void 0,this.divHost=t,this.width=i,this.height=a,this.controller=new n(this),this.builder=new s(this),this.builder.initPanel(e)}addIconTopPanel(t){this.controller.addIconTopPanel(t)}addToggleTopPanel(t){this.controller.addToggleTopPanel(t)}addIconLeftPanel(t){this.controller.addIconLeftPanel(t)}addIconLeft(){this.controller.addIconLeft()}getContext(){return this.builder.divForGraphicContext}remove(){this.divHost.removeChild(this.builder.divMain)}updateZindex(){}}var o=i(92621),d=i(14404),l=i(78952);class h{constructor(t){this.app=void 0,this.app=t,this.OpenGeoJsonEx01("")}async OpenGeoJsonEx01(t){}}class r{constructor(t){this.app=void 0,this.app=t,this.AppendMapViewEvent()}AppendMapViewEvent(){this.app.mapView.watch("extent",(()=>{})),this.app.mapView.watch("stationary",(t=>{this.app.renderer.isPanning=!t})),this.app.mapView.watch("ready",(t=>{})),this.app.mapView.on("resize",(t=>{this.app.canvas.ResizeCanvas(t.width,t.height)}))}}class p{constructor(t){this.app=void 0,this.ToMap=(t,e)=>{let i=this.app.mapView.toMap({x:t,y:e}).clone();return[i.longitude,i.latitude,i.x,i.y]},this.ToScreen=(t,e)=>{this.app.mPoint.longitude=t,this.app.mPoint.latitude=e,this.app.mPoint.spatialReference=this.app.mapView.spatialReference;let i=this.app.mapView.toScreen(this.app.mPoint);return[i.x,i.y]},this.app=t}ToScreenFromProjected(t,e){this.app.mPoint.x=t,this.app.mPoint.y=e,this.app.mPoint.spatialReference=this.app.mapView.spatialReference;let i=this.app.mapView.toScreen(this.app.mPoint);return[i.x,i.y]}ToScreenFromGeoPos(t,e){let i=this.app.mapView.toMap({x:t,y:e}).clone();i.longitude=t,i.latitude=e;let n=this.app.mapView.toScreen(i);return[n.x,n.y]}ToScreenFromProjectedPos(t,e){let i=this.app.mapView.toMap({x:t,y:e}).clone(),n=this.app.mapView.toScreen(i);return[n.x,n.y]}ToScreenOld(t,e){let i=this.app.mapView.toMap({x:t,y:e}).clone();i.spatialReference.wkid=102100,i.longitude=t,i.latitude=e;let n=this.app.mapView.toScreen(i);return[n.x,n.y]}}class c{constructor(t){this.t=void 0,this.frameRate=void 0,this.canvas=void 0,this.hostDiv=void 0,this.id=void 0,this.ctx=void 0,this.xOff=void 0,this.yOff=void 0,this.xOffCurrent=void 0,this.yOffCurrent=void 0,this.xOffPre=void 0,this.yOffPre=void 0,this.zoomFactor=void 0,this.zoomFactorPre=void 0,this.zoomFactorCurrent=void 0,this.div3d=void 0,this.smoothingEnabled=!0,this.dropRate=void 0,this.isRenderSkip=void 0,this.isLoop=void 0,this.timeLastRender=void 0,this.delta=void 0,this.now=void 0,this.then=0,this.interval=0,this.last=0,this.frameVisTimer=void 0,this.theDate=void 0,this.asyncSafeGuard=0,this.App=void 0,this.App=t,this.canvas=document.createElement("canvas"),this.canvas.id="App",this.canvas.style.zIndex="1",this.canvas.style.position="absolute",this.canvas.style.pointerEvents="none",this.ctx=this.canvas.getContext("2d"),t.divHost.appendChild(this.canvas),this.ctx.globalCompositeOperation="source-over",this.canvas.width=t.divHost.clientWidth,this.canvas.height=t.divHost.clientHeight,this.Start(this.ctx)}Start(t){this.App.renderer.Init(t),this.Draw(this.ctx)}Draw(t){requestAnimationFrame((()=>{this.Draw(t)})),this.Clear(t),this.Render(t)}Clear(t){t.clearRect(0,0,t.canvas.width,t.canvas.height)}Render(t){this.App.renderer.Render(t)}ResizeCanvas(t,e){this.ctx.canvas.width=t,this.ctx.canvas.height=e}}var v=i(91769);class w{constructor(t){this.app=void 0,this.app=t,w.mouseEventDataPre=new v.$E,this.InitArcGISMapEventV4x()}InitArcGISMapEventV4x(){this.app.mapView.on("click",(t=>{const e=this.CommonEventBuilderArcGIS(t);e.type=v.zK.LEFT,2===t.native.button?e.type=v.zK.RIGHT:1===t.native.button&&(e.type=v.zK.MIDDLE),this.app.MouseEvent(e)})),this.app.mapView.on("pointer-down",(t=>{const e=this.CommonEventBuilderArcGIS(t);e.type=v.zK.DOWN,this.app.MouseEvent(e)})),this.app.mapView.on("pointer-up",(t=>{const e=this.CommonEventBuilderArcGIS(t);e.type=v.zK.UP,this.app.MouseEvent(e)})),this.app.mapView.on("pointer-move",(t=>{const e=this.CommonEventBuilderArcGIS(t);e.type=v.zK.MOVE,this.app.MouseEvent(e)})),this.app.mapView.on("drag",(t=>{const e=this.CommonEventBuilderArcGIS(t);e.type=v.zK.DRAG,this.app.MouseEvent(e),this.app.ableToPan||t.stopPropagation()})),this.app.mapView.on("key-down",(t=>{"Arrow"!==t.key.slice(0,5)&&"-"!==t.key&&"="!==t.key&&"d"!==t.key||t.stopPropagation(),this.KeyDownJSAPI4X(t.native)})),this.app.mapView.on("key-up",(t=>{"Arrow"!==t.key.slice(0,5)&&"-"!==t.key&&"="!==t.key&&"d"!==t.key||t.stopPropagation(),this.KeyDownJSAPI4X(t.native)}))}MouseClickLeftArcGIS(t){let e=this.CommonEventBuilderArcGIS(t);this.app.MouseEvent(e)}CommonEventBuilderArcGIS(t){let e=new v.$E;return e.preX=w.mouseEventDataPre.x,e.preY=w.mouseEventDataPre.y,e.x=t.x,e.y=t.y,e.yGLPicking=t.native.target.getBoundingClientRect().bottom-t.native.clientY,e.pressedShift=t.native.shiftKey,e.pressedAlt=t.native.altKey,e.pressedCtrl=t.native.ctrlKey,e.native=t.native,w.mouseEventDataPre=e,e}KeyDownJSAPI4X(t){let e=this.CommonEventBuilder(t);this.app.KeyEvent(e)}CommonEventBuilder(t){let e=new v.ON;return e.key=t.key,e.keyCode=t.keyCode,e.code=t.code,e.hasCtrlKey=t.ctrlKey,e.hasShiftKey=t.shiftKey,e.hasAltKey=t.altKey,e.hasMetaCommand=t.metaKey,e}}w.mouseEventDataPre=void 0;class y{constructor(t){this.sandbox=void 0,this.p=[],this.num=0,this.isPanning=!1,this.renderer=[],this.sandbox=t}Init(t){}Render(t){for(let e=0;e<this.renderer.length;++e)this.renderer[e](t,this.isPanning)}}class m{static start(t){new m(t)}constructor(t){this.mapView=void 0,this.map=void 0,this.mPoint=void 0,this.divHost=void 0,this.arcGIS=void 0,this.io=void 0,this.canvas=void 0,this.projection=void 0,this.eventInteraction=void 0,this.renderer=void 0,this.ableToPan=!0,this.keyEvents=[],this.MouseEvents=[],this.renderer=new y(this);const e=new d.Z({basemap:"dark-gray-vector"});this.map=e,new o.Z({map:e,container:t,center:[-73.989502,40.741286],zoom:13}).when((t=>{this.mapView=t,this.mapView.spatialReference=l.Z.WebMercator,this.mPoint=this.mapView.toMap({x:0,y:0}),this.divHost=this.mapView.container,this.io=new h(this),this.eventInteraction=new w(this),this.projection=new p(this),this.canvas=new c(this),this.arcGIS=new r(this)}))}appendRenderer(t){this.renderer.renderer.push(t)}appendEventListener(t){this.MouseEvents.push(t.mouse),this.keyEvents.push(t.keyboard)}MouseEvent(t){for(let e=0;e<this.MouseEvents.length;++e)this.MouseEvents[e](t)}KeyEvent(t){for(let e=0;e<this.keyEvents.length;++e)this.keyEvents[e](t)}}var u=i(47002),x=i(77798);class g{constructor(t){this.njsSandbox=void 0,this.drawingEngine=void 0,this.nna=void 0,this.njsSandbox=t}async initBinding(){this.njsSandbox.win=new a(this.njsSandbox.div,"NNA Engine V4 by NJSTUDIO",1200,600),this.njsSandbox.env=await new m(this.njsSandbox.win.getContext()),this.drawingEngine=new x.J,this.drawingEngine.updateProjection({toMap:(t,e)=>this.njsSandbox.env.projection.ToMap(t,e),toScreen:(t,e)=>this.njsSandbox.env.projection.ToScreen(t,e)}),this.drawingEngine.bindAbleToPan=t=>{this.njsSandbox.env.ableToPan=t},this.njsSandbox.env.appendEventListener({mouse:t=>this.drawingEngine.mouseEvent(t),keyboard:t=>this.drawingEngine.keyEvent(t)}),this.nna=new u.V,this.nna.updateProjection({toMap:(t,e)=>this.njsSandbox.env.projection.ToMap(t,e),toScreen:(t,e)=>this.njsSandbox.env.projection.ToScreen(t,e)}),this.njsSandbox.env.appendEventListener({mouse:t=>this.nna.mouseEvent(t),keyboard:t=>this.nna.keyEvent(t)}),this.njsSandbox.env.appendRenderer(((t,e)=>this.nna.render(t,e))),this.njsSandbox.env.appendRenderer(((t,e)=>this.drawingEngine.render(t,e))),this.njsSandbox.win.addIconLeftPanel({text:"save",callBack:()=>this.drawingEngine.setCommand("save")}),this.njsSandbox.win.addIconLeftPanel({text:"load",callBack:()=>this.drawingEngine.setCommand("load")}),this.njsSandbox.win.addIconLeftPanel({text:"Select",callBack:()=>this.drawingEngine.setCommand("SELECT")}),this.njsSandbox.win.addIconLeftPanel({text:"Point",callBack:()=>this.drawingEngine.setCommand("POINT")}),this.njsSandbox.win.addIconLeftPanel({text:"Line",callBack:()=>this.drawingEngine.setCommand("LINE")}),this.njsSandbox.win.addIconLeftPanel({text:"Polyl",callBack:()=>this.drawingEngine.setCommand("POLYLINE")}),this.njsSandbox.win.addIconLeftPanel({text:"Circle",callBack:()=>this.drawingEngine.setCommand("CIRCLE")}),this.njsSandbox.win.addIconLeftPanel({text:"Rect",callBack:()=>this.drawingEngine.setCommand("RECTANGLE")}),this.njsSandbox.win.addIconLeftPanel({text:"ZipData",callBack:()=>this.drawingEngine.apiCall("importZipData")}),this.njsSandbox.win.addIconLeftPanel({text:"clusterGrid",callBack:()=>this.drawingEngine.apiCall("importClustering")}),this.njsSandbox.win.addIconLeftPanel({text:"clusterCol",callBack:()=>this.drawingEngine.apiCall("importClusteringCollision")}),this.njsSandbox.win.addIconTopPanel({text:"import",width:60,callBack:()=>this.nna.importDummyData()}),this.njsSandbox.win.addIconTopPanel({text:"Origin",width:60,callBack:()=>{this.nna.apiCall(v.lw.NETWORK,"addOrigins",this.drawingEngine.apiCall("getSelectedCPoint"))}}),this.njsSandbox.win.addIconTopPanel({text:"Destination",width:90,callBack:()=>{this.nna.apiCall(v.lw.NETWORK,"addDestinations",this.drawingEngine.apiCall("getSelectedCPoint"))}}),this.njsSandbox.win.addIconTopPanel({text:"Agent",width:90,callBack:()=>{this.nna.apiCall(v.lw.AGENCY,"runAgent",void 0)}}),this.njsSandbox.win.addIconTopPanel({text:"pathOpti",width:90,callBack:()=>{this.nna.apiCall(v.lw.GA,"pathOptimization",this.drawingEngine.apiCall("getSelectedCPoint"))}}),this.njsSandbox.win.addIconTopPanel({text:"Inspection",width:90,callBack:()=>{this.nna.controller.inspection=!this.nna.controller.inspection,this.drawingEngine.activeCommand.inspection=!this.drawingEngine.activeCommand.inspection}}),this.njsSandbox.win.addIconTopPanel({text:"Capture",width:60,callBack:()=>this.nna.apiCall(v.lw.NETWORK,"capture",void 0)}),this.njsSandbox.win.addIconTopPanel({text:"Download",width:60,callBack:()=>this.nna.apiCall(v.lw.NETWORK,"download",void 0)})}}}}]);
//# sourceMappingURL=8081.953462a2.chunk.js.map
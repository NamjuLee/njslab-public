"use strict";(self.webpackChunkNJS_Lab=self.webpackChunkNJS_Lab||[]).push([[89786],{89786:(t,e,s)=>{s.r(e),s.d(e,{Solution:()=>r});var o=s(5483),i=s.n(o);class n{constructor(t,e){this.id=void 0,this.type=void 0,this.renderingMode=void 0,this.map=void 0,this.canvas=void 0,this.context=void 0,this.polygonsData=void 0,this.popup=void 0,this.hoveredPolygonId=null,this.cachedScreenPolygon=[],this.map=t,this.id="polygon-layer",this.type="custom",this.renderingMode="2d",this.polygonsData=e,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.top="0",this.canvas.style.left="0";const s=this.canvas.getContext("2d");if(!s)throw new Error("Failed to get 2D context");this.context=s,this.canvas.addEventListener("mousemove",this.onMouseMove.bind(this)),this.canvas.addEventListener("click",this.onClick.bind(this)),this.cachedScreenPolygon=[]}onMouseMove(t){const e=this.canvas.getBoundingClientRect(),s=t.clientX-e.left,o=t.clientY-e.top;this.hoveredPolygonId=null,this.canvas.style.cursor="",this.polygonsData.features.forEach(((t,e)=>{this.isPointInPolygon([s,o],t.geometry.coordinates)&&(this.hoveredPolygonId=e,this.canvas.style.cursor="pointer")})),this.map.triggerRepaint()}onClick(t){const e=this.canvas.getBoundingClientRect(),s=t.clientX-e.left,o=t.clientY-e.top;this.polygonsData.features.forEach(((t,e)=>{this.isPointInPolygon([s,o],t.geometry.coordinates)&&(this.popup&&this.popup.remove(),this.popup=(new(i().Popup)).setLngLat(t.geometry.coordinates[0][0]).setHTML('\n                        <div style="padding: 10px;">\n                            <h3>Polygon Information</h3>\n                            <p>'.concat(t.properties.description||"No description","</p>\n                        </div>\n                    ")).addTo(this.map))}))}isPointInPolygon(t,e,s){if(e.length>1)return this.isPointInPolygonMul(t,e);const[o,i]=t,n=e[0].map((t=>this.map.project(t)));let a=!1;for(let h=0,r=n.length-1;h<n.length;r=h++){const{x:t,y:e}=n[h],{x:s,y:c}=n[r];e>i!==c>i&&o<(s-t)*(i-e)/(c-e)+t&&(a=!a)}return a}isPointInPolygonMul(t,e,s){const[o,i]=t;let n=!1;for(const a of e){const t=a.map((t=>Array.isArray(t)&&2===t.length?this.map.project(t):void 0!==t.lng&&void 0!==t.lat?this.map.project({lng:t.lng,lat:t.lat}):void 0!==t.lon&&void 0!==t.lat?this.map.project({lon:t.lon,lat:t.lat}):(console.warn("Invalid coordinate format:",t),null))).filter((t=>null!==t));let e=!1;for(let s=0,n=t.length-1;s<t.length;n=s++){const{x:a,y:h}=t[s],{x:r,y:c}=t[n];h>i!==c>i&&o<(r-a)*(i-h)/(c-h)+a&&(e=!e)}e&&(n=!0)}return n}onAdd(t){this.resizeCanvas(),t.getCanvasContainer().appendChild(this.canvas),t.on("resize",this.resizeCanvas.bind(this))}render(){const t=this.context;return t.clearRect(0,0,this.canvas.width,this.canvas.height),this.polygonsData.features.forEach(((e,s)=>{if("MultiPolygon"===e.geometry.type)e.geometry.coordinates.forEach((e=>{const o=e[0].map((t=>this.map.project(t)));t.beginPath(),o.forEach(((e,s)=>{0===s?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y)})),t.closePath(),this.hoveredPolygonId===s?t.fillStyle="rgba(255, 0, 0, 0.5)":t.fillStyle="rgba(0, 0, 255, 0.5)",t.fill(),t.strokeStyle="#FFFFFF",t.lineWidth=2,t.stroke()}));else if("Polygon"===e.geometry.type){const o=e.geometry.coordinates[0].map((t=>this.map.project(t)));t.beginPath(),o.forEach(((e,s)=>{0===s?t.moveTo(e.x,e.y):t.lineTo(e.x,e.y)})),t.closePath(),this.hoveredPolygonId===s?t.fillStyle="rgba(255, 0, 0, 0.5)":t.fillStyle="rgba(0, 0, 255, 0.5)",t.fill(),t.strokeStyle="#FFFFFF",t.lineWidth=2,t.stroke()}})),!0}onRemove(){this.popup&&this.popup.remove(),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.map.off("resize",this.resizeCanvas)}resizeCanvas(){const t=this.map.getCanvas();this.canvas.width=t.width,this.canvas.height=t.height}}class a{constructor(t,e){this.id=void 0,this.type=void 0,this.renderingMode=void 0,this.map=void 0,this.canvas=void 0,this.context=void 0,this.pointsData=void 0,this.popup=void 0,this.hoveredPointId=null,this.animationStartTime=void 0,this.animate=()=>{this.map.triggerRepaint(),requestAnimationFrame(this.animate)},this.map=t,this.id="points-layer",this.type="custom",this.renderingMode="2d",this.pointsData=e,this.animationStartTime=Date.now(),this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.top="0",this.canvas.style.left="0";const s=this.canvas.getContext("2d");if(!s)throw new Error("Failed to get 2D context");this.context=s,this.canvas.addEventListener("mousemove",this.onMouseMove.bind(this)),this.canvas.addEventListener("click",this.onClick.bind(this)),this.animate()}getAnimatedSize(t,e){const s=Date.now()-this.animationStartTime,o=e*(Math.PI/4);return t*(1+.2*Math.sin(.002*s+o))}getHoverColor(t){const e=Date.now()-this.animationStartTime;return"hsl(".concat(.1*e%360,", 100%, 50%)")}onMouseMove(t){const e=this.canvas.getBoundingClientRect(),s=t.clientX-e.left,o=t.clientY-e.top;this.canvas.style.cursor="",this.hoveredPointId=null;for(let i=0;i<this.pointsData.features.length;i++){const t=this.pointsData.features[i];if(this.isPointUnderMouse(t.geometry.coordinates,s,o,t.properties.size?t.properties.size:5)){this.hoveredPointId=i,this.canvas.style.cursor="pointer";break}}this.map.triggerRepaint()}onClick(t){const e=this.canvas.getBoundingClientRect(),s=t.clientX-e.left,o=t.clientY-e.top;for(let n=0;n<this.pointsData.features.length;n++){const t=this.pointsData.features[n];if(this.isPointUnderMouse(t.geometry.coordinates,s,o,t.properties.size)){this.popup&&this.popup.remove(),this.popup=(new(i().Popup)).setLngLat(t.geometry.coordinates).setHTML('\n                        <div style="padding: 10px;">\n                            <h3>Point Information</h3>\n                            <p>Size: '.concat(t.properties.size,"</p>\n                            <p>Color: ").concat(t.properties.color,"</p>\n                            ").concat(t.properties.description?"<p>".concat(t.properties.description,"</p>"):"","\n                        </div>\n                    ")).addTo(this.map);break}}}isPointUnderMouse(t,e,s,o){const i=this.map.project(t);return Math.sqrt(Math.pow(i.x-e,2)+Math.pow(i.y-s,2))<=o}onAdd(t){this.resizeCanvas(),t.getCanvasContainer().appendChild(this.canvas),t.on("resize",this.resizeCanvas.bind(this))}render(){const t=this.context;return t.clearRect(0,0,this.canvas.width,this.canvas.height),this.pointsData.features.forEach(((e,s)=>{const o=e.geometry.coordinates,i=e.properties,n=this.map.project(o),a=this.getAnimatedSize(i.size?i.size:5,s);t.beginPath(),t.arc(n.x,n.y,a,0,2*Math.PI),this.hoveredPointId===s?(t.fillStyle="#f00",t.shadowColor="white",t.shadowBlur=20):(t.fillStyle="#00f",t.shadowBlur=0),t.fill(),t.strokeStyle="#FFFFFF",t.lineWidth=2,t.stroke(),t.shadowBlur=0})),!0}onRemove(){this.popup&&this.popup.remove(),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.map.off("resize",this.resizeCanvas)}resizeCanvas(){const t=this.map.getCanvas();this.canvas.width=t.width,this.canvas.height=t.height}}class h{constructor(t){var e=this;this.map=void 0,this.center=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-99.292649,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:39.043903;e.map.setCenter({lat:s,lng:t})},this.toMap=(t,e)=>{const s=this.map.unproject({x:t,y:e});return[s.lng,s.lat]},this.toScreen=(t,e)=>{const s=this.map.project([t,e]);return[s.x,s.y]},this.mouseDown=t=>{},this.mouseUp=t=>{},this.mouseMove=t=>{},this.mouseClick=t=>{},this.mouseDClick=t=>{};(async()=>{try{const t=await fetch("/njs-lab-public/static/dataDummyReady/underserved_locations.geojson");if(!t.ok)throw new Error("Failed to load GeoJSON data");const e=await t.json();console.log(e);const s=new a(this.map,e);this.map.addLayer(s)}catch(t){console.error("Error fetching GeoJSON:",t)}})();(async()=>{try{const t=await fetch("/njs-lab-public/static/data/us_counties.geojson");if(!t.ok)throw new Error("Failed to load GeoJSON data");const e=await t.json();console.log(e);const s=new n(this.map,e);this.map.addLayer(s)}catch(t){console.error("Error fetching GeoJSON:",t)}})(),this.initMap(t)}initMap(t){i().accessToken="pk.eyJ1IjoiZGVzaWduanUiLCJhIjoiY2xhNGU0YWo4MDlhYzNwdHBwenVvang4eiJ9.P3sX4l_3KjdPeRRbVS1VVg",this.map=new(i().Map)({container:t,zoom:5,center:[-71.093161,42.358871],style:"mapbox://styles/mapbox/dark-v10"}),this.map.dragRotate.disable(),this.map.on("mousemove",(t=>{this.mouseMove(t)})),this.map.on("click",(t=>{this.mouseClick(t)})),this.map.on("mousedown",(t=>{this.mouseDown(t)})),this.map.on("dblclick",(t=>{this.mouseDClick(t)})),this.map.on("mouseup",(t=>{this.mouseUp(t)}));let e=document.getElementsByClassName("mapboxgl-canvas")[0];e.style.position="absolute",e=document.getElementsByClassName("mapboxgl-control-container")[0],e.style.display="none",this.map.on("load",(()=>{this.map.on("move",(()=>{this.map.triggerRepaint()}))}))}}class r{constructor(t){this.divHost=void 0,this.mapboxWrapper=void 0,this.mouseDown=t=>{},this.mouseUp=t=>{},this.mouseDrag=t=>{},this.mouseClick=t=>{},this.mouseMove=t=>{},this.divHost=document.getElementById(t),this.divHost.style.position="relative",this.mapboxWrapper=new h(this.divHost.id),this.mapboxWrapper.mouseDown=this.mouseDown,this.mapboxWrapper.mouseUp=this.mouseUp,this.mapboxWrapper.mouseClick=this.mouseClick,this.mapboxWrapper.mouseMove=this.mouseMove}keyDown(t){}destroy(){for(;this.divHost.lastElementChild;)this.divHost.removeChild(this.divHost.lastElementChild)}}}}]);
//# sourceMappingURL=89786.45b9a3d5.chunk.js.map